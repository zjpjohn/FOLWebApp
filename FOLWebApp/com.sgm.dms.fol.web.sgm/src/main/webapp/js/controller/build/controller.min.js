/*! web.sgm 2016-09-28 */
FolController.controller("DealerInfoController",["$scope","$rootScope","$state","$stateParams","$timeout","$window","DealerInfoService",function(a,b,c,d,e,f,g){e(function(){var b=$("#datagridWaitSelected").datagrid("getPager");b.pagination({onSelectPage:function(b,c){a.query_data.beginNo=c*(b-1)==0?0:c*(b-1)+1,a.query_data.endNo=c*b,$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),g.query(a.query_data,"dealerInfo/dealerInfoPageList",function(a,b){$.messager.progress("close"),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}})}),a.findDealerReset=function(){$("#sapCode").textbox("setValue",null),$("#dealerName").textbox("setValue",null),$("#province").combobox("select",-1),$("#city").combobox("select",-1),$("#region").combobox("select",-1)},a.queryDealer=function(){a.query_data={sapCode:$("#sapCode").textbox("getValue"),dealerName:$("#dealerName").textbox("getValue"),beginNo:0,endNo:10},$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),g.query(a.query_data,"dealerInfo/dealerInfoPageList",function(a,b){$.messager.progress("close"),$("#datagridWaitSelected").datagrid("loadData",{rows:[],total:0}),$("#datagridWaitSelected").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT?(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问")):$.messager.alert("提示","查询失败，原因："+a.message)})},a.left=function(){var a=$("#datagridWaitSelected").datagrid("getSelections");if(a.length<=0)return void $.messager.alert("提示","请选择一条数据再操作");var b=$("#datagridSelected").datagrid("getRows");angular.forEach(a,function(a,c){b.length>0?angular.forEach(b,function(b,c){a.sapCode!==b.sapCode&&$("#datagridSelected").datagrid("appendRow",a)}):$("#datagridSelected").datagrid("appendRow",a)})},a.right=function(){var a=$("#datagridSelected").datagrid("getSelections");return a.length<=0?void $.messager.alert("提示","请选择一条数据再操作"):void angular.forEach(a,function(a,b){var c=$("#datagridSelected").datagrid("getRowIndex",a);$("#datagridSelected").datagrid("deleteRow",c)})},a.leftAll=function(){var a=$("#datagridWaitSelected").datagrid("getRows");$("#datagridSelected").datagrid("loadData",{total:0,rows:[]}),angular.forEach(a,function(a,b){$("#datagridSelected").datagrid("appendRow",a)})},a.rightAll=function(){$("#datagridSelected").datagrid("loadData",{total:0,rows:[]})},a.submit=function(){var a=$("#datagridSelected").datagrid("getRows"),b="";angular.forEach(a,function(a,c){b+=a.sapCode+","}),b=b.substr(0,b.length-1),c.go(d.stateName,{data:{sapCodes:b}})},a.cancel=function(){f.history.back()}}]),FolController.controller("uploadFileController",["$rootScope","$scope","$window","$timeout","$stateParams","uploadFileService","CodeService",function(a,b,c,d,e,f,g){function h(a){"bill"===e.pageName?(a.effectDate=$("#effectDate").datebox("getValue"),a.billDate=$("#billDate").datebox("getValue")):"bonusIssueVersion"===e.pageName?(a.dealerType=folUtil.getComboBoxDataById("dealerType"),a.bonusType=folUtil.getComboBoxDataById("bonusType")):"bankTicketInterest"===e.pageName&&(a.year=folUtil.getComboBoxDataById("year"),a.month=folUtil.convertMonthToTwoPoint(folUtil.getComboBoxDataById("month")))}function i(){if("bonusIssueVersion"===e.pageName){if(-1==folUtil.getComboBoxDataById("dealerType"))return $.messager.alert("提示","渠道类型不能为空"),!1;if(-1==folUtil.getComboBoxDataById("bonusType"))return $.messager.alert("提示","奖金类型不能为空"),!1}return!0}function j(){if(console.log(e.pageName),"bonusIssueVersion"===e.pageName){var a=["渠道类型","奖金类型"];$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),g.findCodeTypeNames(a,"code/findCodeTypeNames",function(a){$.messager.progress("close");var b=["#dealerType","#bonusType"];d(function(){for(var c=0;c<a.length;c++)folUtil.isNull(a[c])||($(b[c]).combobox("loadData",a[c]),$(b[c]).combobox("select",a[c][0].code))})},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}else"bankTicketInterest"===e.pageName&&(d(function(){folUtil.setComboBoxYearDataById("year"),folUtil.setComboBoxMonthDataById("month")}),console.log(3))}b.pageName=e.pageName,d(j()),b.cancel=function(){c.history.back()},b.openDownloadFile=function(){f.openDownloadFile("services/tokens",function(a){$.each(a,function(a,b){"token"==a&&(alert($("#result").val().filename),c.open("http://dapi.saic-gm.com/fileservice/html/download.html?token="+b+"&fileId="+$("#result").val(),"_blank","height=300,width=600,scrollbars=no,location=no"))})},function(a){console.log(a)})},b.openUploadFile=function(){f.openUploadFile("services/tokens",function(a){console.log("data:"+a),$.each(a,function(a,b){"token"==a&&c.open("http://dapi.saic-gm.com/fileservice/html/upload.html?token="+b+"&resultId=result&resultName=resultName","_blank","height=300,width=600,scrollbars=no,location=no")})},function(a){console.log(a)})},b.saveFile=function(){f.getToken("services/tokens",function(a,b){$.each(a,function(a,b){if("token"==a){var d={filePath:"http://dapi.saic-gm.com/fileservice/v1/files/"+$("#result").val()+"?token="+b,data:e.data,filedId:$("#result").val(),fileName:$("#resultName").val(),token:b};if(folUtil.isNull($("#result").val()))return void $.messager.alert("提示","请选择文件再上传");if(!i())return;h(d),$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),$.each(UPLOAD_URL,function(a,b){a.toLowerCase()===e.pageName.toLowerCase()&&f.saveFile(d,b,function(a){c.history.back(),$.messager.progress("close"),$.messager.alert("提示","上传文件成功")},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT?(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问")):$.messager.alert("提示",a.message)})})}})},function(a){console.log(a)})}}]),FolController.controller("BankSpecialDealerMaintainController",["$scope","$timeout","$state","$q","BankSpecialDealerMaintainService","CodeService",function(a,b,c,d,e,f){b(function(){if($("#datagrid").length>0){var c=$("#datagrid").datagrid("getPager");c.pagination({onSelectPage:function(b,c){a.query_data.beginNo=c*(b-1)==0?0:c*(b-1)+1,a.query_data.endNo=c*b,$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),e.query(a.query_data,"bankTicket/dealerBankRelevance/query",function(a,b){$.messager.progress("close"),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}})}$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT});var d=["渠道类型","品牌","银票审核状态"];f.findCodeTypeNames(d,"code/findCodeTypeNames",function(a){$.messager.progress("close");var c=["#dealerType","#brand","#auditStatus"];b(function(){for(var b=0;b<a.length;b++)if(!folUtil.isNull(a[b]))if("银票审核状态"==a[b][1].typeName){var d=[];$.each(a[b],function(a,b){b.codeCnDesc.indexOf("修改")<0&&d.push(b)}),$(c[b]).combobox("loadData",d),$(c[b]).combobox("select",d[0].code)}else $(c[b]).combobox("loadData",a[b]),$(c[b]).combobox("select",a[b][0].code)})},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}),a.insert=function(){c.go("addBankSpecialDealer")},a["import"]=function(){c.go("uploadFileController",{pageName:"bankSpecialDealer"})},a.deleteSpecialDealer=function(){var b=d.defer(),c=b.promise,f=$("#datagrid").datagrid("getSelections");return f.length<=0?void $.messager.alert("提示","请选择一条记录，再进行删除操作"):f.length>1?void $.messager.alert("提示","只能选择一条记录，再进行删除操作"):f[0].auditStatus==STATE.BANK_TICKET_ADD_UN_AUDIT||f[0].auditStatus==STATE.BANK_TICKET_UPDATE_UN_AUDIT||f[0].auditStatus==STATE.BANK_TICKET_DELETE_UN_AUDIT?void $.messager.alert("提示","当前状态是待审核不能给予删除"):(e.deleteSpecialDealer(f[0],"bankTicket/dealerBankRelevance/delete",function(a,c){b.resolve("success")},function(a){b.reject("fail")}),void c.then(function(b){$.messager.alert("提示","删除银行特殊经销商成功"),$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),e.query(a.query_data,"bankTicket/dealerBankRelevance/query",function(a,b){$.messager.progress("close"),$("#datagrid").datagrid("loadData",{total:0,rows:[]}),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})},function(a){$.messager.alert("提示","删除银行特殊经销商失败")}))},a.query=function(){a.istableshow=!0,a.query_data={dealerType:folUtil.getComboBoxDataById("dealerType"),sapCode:a.sapCode,dealerName:a.dealerName,brand:folUtil.getComboBoxDataById("brand"),auditStatus:folUtil.getComboBoxDataById("auditStatus"),beginNo:0,endNo:10},$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),e.query(a.query_data,"bankTicket/dealerBankRelevance/query",function(a,b){$.messager.progress("close"),$("#datagrid").datagrid("loadData",{total:0,rows:[]}),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}}]),FolController.controller("AddBankSpecialDealerController",["$scope","$timeout","$state","$q","BankSpecialDealerMaintainService","CodeService",function(a,b,c,d,e,f){function g(){return-1==folUtil.getComboBoxDataById("dealerType")?($.messager.alert("提示","渠道类型不能为空"),!1):-1==folUtil.getComboBoxDataById("bank")?($.messager.alert("提示","银行不能为空"),!1):folUtil.isNull($("#sapCode").textbox("getValue"))?($.messager.alert("提示","客户代码不能为空"),!1):!0}b(function(){$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT});var a=["渠道类型"];f.findCodeTypeNames(a,"code/findCodeTypeNames",function(a){$.messager.progress("close");var c=["#dealerType","#mainTainType"];b(function(){for(var b=0;b<a.length;b++)folUtil.isNull(a[b])||($(c[b]).combobox("loadData",a[b]),$(c[b]).combobox("select",a[b][0].code))})},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))}),e.getBankInfoAllList("bankTicket/dealerBankRelevance/getBankInfoAllList",function(a,c){var d=[];d.push({bankAbbr:-1,bankChName:"请选择"}),$.each(a,function(a,b){d.push(b)}),b(function(){$("#bank").combobox("loadData",d),$("#bank").combobox("select",d[0].bankAbbr)})},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}),a.addBankSpecialDealer=function(){var a={dealerType:folUtil.getComboBoxDataById("dealerType"),bankAbbr:folUtil.getComboBoxDataById("bank"),sapCode:$("#sapCode").textbox("getValue")};g()&&e.addBankSpecialDealer(a,"bankTicket/dealerBankRelevance/add",function(a,b){$.messager.alert("提示","新增银行特殊经销商成功"),c.go("bankSpecialDealerMaintain")},function(a){$.messager.alert("提示","新增银行特殊经销商失败")})},a.cancel=function(){c.go("bankSpecialDealerMaintain")}}]),FolController.controller("BankTicketDeadLineMaintainController",["$scope","$timeout","$state","$q","$stateParams","BankTicketDeadLineMaintainService","CodeService",function(a,b,c,d,e,f,g){var h="brand";b(function(){if($("#branddatagrid").length>0){var c=$("#branddatagrid").datagrid("getPager");c.pagination({onSelectPage:function(b,c){a.query_data.beginNo=c*(b-1)==0?0:c*(b-1)+1,a.query_data.endNo=c*b,$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),f.query(a.query_data,"bankTicket/deadLine/queryBrand",function(a,b){$.messager.progress("close"),$("#branddatagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}}),a.query_data={beginNo:0,endNo:10},$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),f.query(a.query_data,"bankTicket/deadLine/queryBrand",function(a,b){$.messager.progress("close"),$("#branddatagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}if($("#specialdealerdatagrid").length>0){var c=$("#specialdealerdatagrid").datagrid("getPager");c.pagination({onSelectPage:function(b,c){a.query_data.beginNo=c*(b-1)==0?0:c*(b-1)+1,a.query_data.endNo=c*b,$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),f.query(a.query_data,"bankTicket/deadLine/querySpecialDealer",function(a,b){$.messager.progress("close"),$("#specialdealerdatagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}})}$(".sgm_tabs").tabs({onSelect:function(c){if("维护特殊经销商"==c){h="specialDealer",$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT});var d=["渠道类型","品牌","银票审核状态"];g.findCodeTypeNames(d,"code/findCodeTypeNames",function(c){$.messager.progress("close");var d=["#dealerType","#brand","#auditStatus"];b(function(){for(var a=0;a<c.length;a++)if(!folUtil.isNull(c[a]))if("银票审核状态"==c[a][1].typeName){var b=[];$.each(c[a],function(a,c){c.codeCnDesc.indexOf("修改")<0&&b.push(c)}),$(d[a]).combobox("loadData",b),$(d[a]).combobox("select",b[0].code)}else $(d[a]).combobox("loadData",c[a]),$(d[a]).combobox("select",c[a][0].code)}),$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),f.query(a.query_data,"bankTicket/deadLine/querySpecialDealer",function(a,b){$.messager.progress("close"),$("#specialdealerdatagrid").datagrid("loadData",{total:0,rows:[]}),$("#specialdealerdatagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}else h="brand",$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),a.query_data={beginNo:0,endNo:10},f.query(a.query_data,"bankTicket/deadLine/queryBrand",function(a,b){$.messager.progress("close"),$("#branddatagrid").datagrid("loadData",{total:0,rows:[]}),$("#branddatagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}})}),a.addBankTicketDeadLingBrand=function(){c.go("addBankTicketDeadLineBrandOrSpecialDealer",{data:{maintainType:1}})},a.addBankTicketDeadLingSpecialDealer=function(){c.go("addBankTicketDeadLineBrandOrSpecialDealer",{data:{maintainType:2}})},a.updateBankTicketDeadLingBrand=function(){var a=$("#branddatagrid").datagrid("getSelections");return a.length<=0?void $.messager.alert("提示","请选择一条记录，再进行操作"):a.length>1?void $.messager.alert("提示","只能一条记录，再进行操作"):a[0].auditStatus==STATE.BANK_TICKET_ADD_UN_AUDIT||a[0].auditStatus==STATE.BANK_TICKET_UPDATE_UN_AUDIT||a[0].auditStatus==STATE.BANK_TICKET_DELETE_UN_AUDIT?void $.messager.alert("提示","当前状态是待审核不能给予修改"):void c.go("updateBankTicketDeadLineBrandOrSpecialDealer",{data:{maintainType:1,vo:a[0]}})},a.updateBankTicketDeadLingSpecialDealer=function(){var a=$("#specialdealerdatagrid").datagrid("getSelections");return a.length<=0?void $.messager.alert("提示","请选择一条记录，再进行操作"):a.length>1?void $.messager.alert("提示","只能一条记录，再进行操作"):a[0].auditStatus==STATE.BANK_TICKET_ADD_UN_AUDIT||a[0].auditStatus==STATE.BANK_TICKET_UPDATE_UN_AUDIT||a[0].auditStatus==STATE.BANK_TICKET_DELETE_UN_AUDIT?void $.messager.alert("提示","当前状态是待审核不能给予修改"):void c.go("updateBankTicketDeadLineBrandOrSpecialDealer",{data:{maintainType:2,vo:a[0]}})},a["import"]=function(){c.go("uploadFileController",{pageName:"bankSpecialDealer"})},a.deleteBankTicketDeadLine=function(){var b,c=d.defer(),e=c.promise;return"brand"==h?b=$("#branddatagrid").datagrid("getSelections"):"specialDealer"==h&&(b=$("#specialdealerdatagrid").datagrid("getSelections")),b.length<=0?void $.messager.alert("提示","请选择一条记录，再进行删除操作"):b.length>1?void $.messager.alert("提示","只能一条记录，再进行删除操作"):b[0].auditStatus==STATE.BANK_TICKET_ADD_UN_AUDIT||b[0].auditStatus==STATE.BANK_TICKET_UPDATE_UN_AUDIT||b[0].auditStatus==STATE.BANK_TICKET_DELETE_UN_AUDIT?void $.messager.alert("提示","当前状态是待审核不能给予删除"):(f.deleteBankTicketDeadLine(b[0],"bankTicket/deadLine/delete",function(a){c.resolve("success")},function(a){c.reject("fail")}),void e.then(function(b){$.messager.alert("提示","删除银行特殊经销商成功");var c;"brand"==h?c="bankTicket/deadLine/queryBrand":"specialDealer"==h&&(c="bankTicket/deadLine/querySpecialDealer"),$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),f.query(a.query_data,c,function(a,b){$.messager.progress("close"),"brand"==h?($("#branddatagrid").datagrid("loadData",{total:0,rows:[]}),$("#branddatagrid").datagrid("loadData",a)):"specialDealer"==h&&($("#specialdealerdatagrid").datagrid("loadData",{total:0,rows:[]}),$("#specialdealerdatagrid").datagrid("loadData",a))},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})},function(a){$.messager.alert("提示","删除银行特殊经销商失败")}))},a.query=function(){a.istableshow=!0,a.query_data={dealerType:folUtil.getComboBoxDataById("dealerType"),sapCode:$("#sapCode").textbox("getValue"),dealerName:$("#dealerName").textbox("getValue"),brandId:folUtil.getComboBoxDataById("brand"),auditStatus:folUtil.getComboBoxDataById("auditStatus"),beginNo:0,endNo:10},$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),f.query(a.query_data,"bankTicket/deadLine/querySpecialDealer",function(a,b){$.messager.progress("close"),$("#specialdealerdatagrid").datagrid("loadData",{total:0,rows:[]}),$("#specialdealerdatagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}}]),FolController.controller("AddBankTicketDeadLineMaintainController",["$scope","$timeout","$state","$stateParams","$q","BankTicketDeadLineMaintainService","CodeService",function(a,b,c,d,e,f,g){a.data=d.data,b(function(){$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT});var a=["渠道类型","品牌"];g.findCodeTypeNames(a,"code/findCodeTypeNames",function(a){$.messager.progress("close");var c=["#dealerType","#brand"];b(function(){for(var b=0;b<a.length;b++)folUtil.isNull(a[b])||($(c[b]).combobox("loadData",a[b]),$(c[b]).combobox("select",a[b][0].code))})},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}),a.addBankTicketDeadLine=function(){if((1!=a.data.maintainType||a.chenkBrand())&&(2!=a.data.maintainType||a.checkSpecialDealer())){var b={dealerType:folUtil.getComboBoxDataById("dealerType"),brandId:folUtil.getComboBoxDataById("brand"),deadlineDay:$("#deadlineDay").numberbox("getValue"),freePeriodDay:$("#freePeriodDay").numberbox("getValue"),effectDate:$("#effectDate").textbox("getValue")};if(a.checkValue(b)){$("#sapCode").length>0&&(b.sapCode=folUtil.isNull($("#sapCode").textbox("getValue"))?null:$("#sapCode").textbox("getValue"),b.expireDate=folUtil.isNull($("#expireDate").textbox("getValue"))?null:$("#expireDate").textbox("getValue"));var d;d=1==a.data.maintainType?"bankTicket/deadLine/addBrand":"bankTicket/deadLine/addSpecialDealer",f.addBankTicketDeadLine(b,d,function(a){$.messager.alert("提示","新增银票期限成功"),c.go("bankTicketDeadLineMaintain")},function(a){$.messager.alert("提示","新增银票期限失败,")})}}},a.cancel=function(){c.go("bankTicketDeadLineMaintain")},a.chenkBrand=function(){return folUtil.isNull(folUtil.getComboBoxDataById("dealerType"))?($.messager.alert("提示","渠道类型不能为空"),!1):folUtil.isNull(folUtil.getComboBoxDataById("brand"))?($.messager.alert("提示","品牌不能为空"),!1):folUtil.isNull($("#deadlineDay").numberbox("getValue"))?($.messager.alert("提示","票据天数不能为空"),!1):folUtil.isNull($("#freePeriodDay").numberbox("getValue"))?($.messager.alert("提示","免息期不能为空"),!1):folUtil.isNull($("#effectDate").textbox("getValue"))?($.messager.alert("提示","起效日不能为空"),!1):!0},a.checkSpecialDealer=function(){return folUtil.isNull(folUtil.getComboBoxDataById("dealerType"))||-1==folUtil.getComboBoxDataById("dealerType")?($.messager.alert("提示","渠道类型不能为空"),!1):folUtil.isNull(folUtil.getComboBoxDataById("brand"))||-1==folUtil.getComboBoxDataById("brand")?($.messager.alert("提示","品牌不能为空"),!1):folUtil.isNull($("#sapCode").textbox("getValue"))?($.messager.alert("提示","SAP代码不能为空"),!1):folUtil.isNull($("#deadlineDay").numberbox("getValue"))?($.messager.alert("提示","票据天数不能为空"),!1):folUtil.isNull($("#freePeriodDay").numberbox("getValue"))?($.messager.alert("提示","免息期不能为空"),!1):folUtil.isNull($("#effectDate").textbox("getValue"))?($.messager.alert("提示","起效日不能为空"),!1):folUtil.isNull($("#expireDate").textbox("getValue"))?($.messager.alert("提示","到期日不能为空"),!1):!0},a.checkValue=function(a){return parseFloat(a.deadlineDay)<parseFloat(a.freePeriodDay)?($.messager.alert("提示","票据天数不能小于免息天数"),!1):!folUtil.isNull(a.expireDate)&&a.effectDate>=a.expireDate?($.messager.alert("提示","生效日期必须小于到期日期"),!1):!0}}]),FolController.controller("UpdateBankTicketDeadLineMaintainController",["$scope","$timeout","$state","$stateParams","BankTicketDeadLineMaintainService",function(a,b,c,d,e){a.data=d.data,b(function(){$("#dealerType").textbox("setValue",a.data.vo.dealerTypeName),$("#brand").textbox("setValue",a.data.vo.brandName),$("#deadlineDay").textbox("setValue",a.data.vo.deadlineDay),$("#freePeriodDay").textbox("setValue",a.data.vo.freePeriodDay),$("#auditStatus").textbox("setValue",a.data.vo.auditStatusName),$("#effectDate").textbox("setValue",a.data.vo.effectDateDisplay),2==a.data.maintainType&&b(function(){$("#sapCode").textbox("setValue",a.data.vo.sapCode),$("#dealerName").textbox("setValue",a.data.vo.dealerName),$("#expireDate").textbox("setValue",a.data.vo.expireDateDisplay)})}),a.updateDeadLineWithBrand=function(){var b={encryptId:a.data.vo.encryptId,deadlineDay:$("#currentdeadlineDay").numberbox("getValue"),freePeriodDay:$("#currentfreePeriodDay").numberbox("getValue"),effectDate:$("#currenteffectDate").datebox("getValue")};a.checkValue(b)&&e.updateDeadLineWithBrand(b,"bankTicket/deadLine/updateDeadLine",function(a){$.messager.alert("提示","修改银票期限成功"),c.go("bankTicketDeadLineMaintain")},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT?(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问")):$.messager.alert("提示","修改银票期限失败,")})},a.updateDeadLineWithSpecialDealer=function(){var b={encryptId:a.data.vo.encryptId,deadlineDay:$("#currentdeadlineDay").numberbox("getValue"),freePeriodDay:$("#currentfreePeriodDay").numberbox("getValue"),effectDate:$("#currenteffectDate").datebox("getValue"),expireDate:$("#currentexpireDate").datebox("getValue")};a.checkValue(b)&&e.updateDeadLineWithBrand(b,"bankTicket/deadLine/updateDeadLine",function(a){$.messager.alert("提示","修改银票期限成功"),c.go("bankTicketDeadLineMaintain")},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT?(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问")):$.messager.alert("提示","修改银票期限失败,")})},a.cancel=function(){c.go("bankTicketDeadLineMaintain")},a.checkValue=function(a){return parseFloat(a.deadlineDa)<parseFloat(a.freePeriodDay)?($.messager.alert("提示","票据天数不能小于免息天数"),!1):!folUtil.isNull(a.expireDate)&&a.effectDate>=a.expireDate?($.messager.alert("提示","生效日期必须小于到期日期"),!1):!0}}]),FolController.controller("BankTicketLimitAmountMaintainController",["$scope","$timeout","$q","$state","BankTicketLimitAmountMaintainService","CodeService",function(a,b,c,d,e,f){var g="amountLimit";b(function(){if($("#datagrid").length>0){var c=$("#datagrid").datagrid("getPager");c.pagination({onSelectPage:function(b,c){a.query_data.beginNo=c*(b-1)==0?0:c*(b-1)+1,a.query_data.endNo=c*b,$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),e.query(a.query_data,"bankTicket/limitAmount/query",function(a,b){$.messager.progress("close"),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}}),$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),a.query_data={beginNo:0,endNo:10},e.query(a.query_data,"bankTicket/limitAmount/query",function(a,b){$.messager.progress("close"),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}if($("#specialdealerdatagrid").length>0){var c=$("#specialdealerdatagrid").datagrid("getPager");c.pagination({onSelectPage:function(b,c){a.query_data.beginNo=c*(b-1)==0?0:c*(b-1)+1,a.query_data.endNo=c*b,$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),e.query(a.query_data,"bankTicket/limitAmount/querySpecialDealer",function(a,b){$.messager.progress("close"),$("#specialdealerdatagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}}),a.query_data={beginNo:0,endNo:10},$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),e.query(a.query_data,"bankTicket/limitAmount/querySpecialDealer",function(a,b){$.messager.progress("close"),$("#specialdealerdatagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}$(".sgm_tabs").tabs({onSelect:function(c){if("维护特殊经销商"==c){g="specialDealer",$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT});var d=["渠道类型","品牌","银票审核状态"];f.findCodeTypeNames(d,"code/findCodeTypeNames",function(a){$.messager.progress("close");var c=["#dealerType","#brand","#auditStatus"];b(function(){for(var b=0;b<a.length;b++)if(!folUtil.isNull(a[b]))if("银票审核状态"==a[b][1].typeName){var d=[];$.each(a[b],function(a,b){b.codeCnDesc.indexOf("修改")<0&&d.push(b)}),$(c[b]).combobox("loadData",d),$(c[b]).combobox("select",d[0].code)}else $(c[b]).combobox("loadData",a[b]),$(c[b]).combobox("select",a[b][0].code)})},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))}),a.query_data={beginNo:0,endNo:10},$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),e.query(a.query_data,"bankTicket/limitAmount/querySpecialDealer",function(a,b){$.messager.progress("close"),$("#specialdealerdatagrid").datagrid("loadData",{total:0,rows:[]}),$("#specialdealerdatagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}else g="limitAomunt",$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),a.query_data={beginNo:0,endNo:10},e.query(a.query_data,"bankTicket/limitAmount/query",function(a,b){$.messager.progress("close"),$("#datagrid").datagrid("loadData",{total:0,rows:[]}),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}})}),a.addBankTicketLimitAmount=function(){d.go("addBankTicketLimitAmountMaintain",{data:{maintainType:1}})},a.addBankTicketLimitAmountSpecialDealer=function(){d.go("addBankTicketLimitAmountMaintain",{data:{maintainType:2}})},a.querySpecialDealer=function(){$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),a.query_data={dealerType:folUtil.getComboBoxDataById("dealerType"),brandId:folUtil.getComboBoxDataById("brand"),sapCode:$("#sapCode").textbox("getValue"),dealerName:$("#dealerName").textbox("getValue"),auditStatus:folUtil.getComboBoxDataById("auditStatus"),beginNo:0,endNo:10},e.query(a.query_data,"bankTicket/limitAmount/querySpecialDealer",function(a,b){$.messager.progress("close"),$("#specialdealerdatagrid").datagrid("loadData",{total:0,rows:[]}),$("#specialdealerdatagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})},a.deleteBankTicketLimitAmount=function(){var b;return b="amountLimit"==g?$("#datagrid").datagrid("getSelections"):$("#specialdealerdatagrid").datagrid("getSelections"),b.length<=0?void $.messager.alert("提示","请选择一条记录，再进行操作"):b.length>1?void $.messager.alert("提示","不能选择多条记录，再进行操作"):b[0].auditStatus==STATE.BANK_TICKET_ADD_UN_AUDIT||b[0].auditStatus==STATE.BANK_TICKET_UPDATE_UN_AUDIT||b[0].auditStatus==STATE.BANK_TICKET_DELETE_UN_AUDIT?void $.messager.alert("提示","当前状态是待审核不能给予删除"):void e.deleteBankTicketLimitAmount(b[0],"bankTicket/limitAmount/delete",function(b){$.messager.alert("提示","删除银票限额成功");var c={};"amountLimit"==g?(c.url="bankTicket/limitAmount/query",c.datagridName="#datagrid"):(c.url="bankTicket/limitAmount/querySpecialDealer",c.datagridName="#specialdealerdatagrid"),e.query(a.query_data,c.url,function(a,b){$.messager.progress("close"),$(c.datagridName).datagrid("loadData",{total:0,rows:[]}),$(c.datagridName).datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT?(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问")):$.messager.alert("提示","删除银票限额失败")})},a.updateBankTicketLimitAmount=function(){var a;return a="amountLimit"==g?$("#datagrid").datagrid("getSelections"):$("#specialdealerdatagrid").datagrid("getSelections"),a.length<=0?void $.messager.alert("提示","请选择一条记录，再进行操作"):a.length>1?void $.messager.alert("提示","不能选择多条记录，再进行操作"):a[0].auditStatus==STATE.BANK_TICKET_ADD_UN_AUDIT||a[0].auditStatus==STATE.BANK_TICKET_UPDATE_UN_AUDIT||a[0].auditStatus==STATE.BANK_TICKET_DELETE_UN_AUDIT?void $.messager.alert("提示","当前状态是待审核不能给予修改"):void d.go("updateBankTicketLimitAmountMaintain",{data:{maintainType:1,vo:a[0]}})},a.updateBankTicketLimitAmountSpecialDealer=function(){var a;return a="amountLimit"==g?$("#datagrid").datagrid("getSelections"):$("#specialdealerdatagrid").datagrid("getSelections"),a.length<=0?void $.messager.alert("提示","请选择一条记录，再进行操作"):a.length>1?void $.messager.alert("提示","不能选择多条记录，再进行操作"):a[0].auditStatus==STATE.BANK_TICKET_ADD_UN_AUDIT||a[0].auditStatus==STATE.BANK_TICKET_UPDATE_UN_AUDIT||a[0].auditStatus==STATE.BANK_TICKET_DELETE_UN_AUDIT?void $.messager.alert("提示","当前状态是待审核不能给予修改"):void d.go("updateBankTicketLimitAmountMaintain",{data:{maintainType:2,vo:a[0]}})}}]),FolController.controller("AddBankTicketLimitAmountMaintainController",["$scope","$timeout","$q","$state","$stateParams","BankTicketLimitAmountMaintainService","CodeService",function(a,b,c,d,e,f,g){function h(){if(folUtil.isNull($("#limitAmount").numberbox("getValue")))return $.messager.alert("提示","票据限额不能为空"),!1;if(folUtil.isNull($("#effectDate").datebox("getValue")))return $.messager.alert("提示","起效日不能为空"),!1;if(2==a.data.maintainType){if(folUtil.isNull(folUtil.getComboBoxDataById("dealerType"))||-1==folUtil.getComboBoxDataById("dealerType"))return $.messager.alert("提示","渠道类型不能为空"),!1;if(folUtil.isNull(folUtil.getComboBoxDataById("brand"))||-1==folUtil.getComboBoxDataById("brand"))return $.messager.alert("提示","品牌不能为空"),!1;if(folUtil.isNull($("#sapCode").textbox("getValue")))return $.messager.alert("提示","客户代码不能为空"),!1;if(folUtil.isNull($("#expireDate").datebox("getValue")))return $.messager.alert("提示","到期日不能为空"),!1}return!0}a.data=e.data,b(function(){if(2==a.data.maintainType){$.messager.progress({title:"Please waiting",
msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT});var c=["渠道类型","品牌"];g.findCodeTypeNames(c,"code/findCodeTypeNames",function(a){$.messager.progress("close");var c=["#dealerType","#brand"];b(function(){for(var b=0;b<a.length;b++)folUtil.isNull(a[b])||($(c[b]).combobox("loadData",a[b]),$(c[b]).combobox("select",a[b][0].code))})},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}}),a.addBankTicketLimitAmount=function(){if(h()){var b,c={amountLimit:$("#limitAmount").numberbox("getValue"),effectDate:$("#effectDate").datebox("getValue")};2==a.data.maintainType?(c.dealerType=folUtil.getComboBoxDataById("dealerType"),c.brandId=folUtil.getComboBoxDataById("brand"),c.sapCode=$("#sapCode").textbox("getValue"),c.expireDate=$("#expireDate").datebox("getValue"),b="bankTicket/limitAmount/addSpecialDealer"):b="bankTicket/limitAmount/add",f.addBankTicketLimitAmount(c,b,function(a){$.messager.alert("提示","新增银票限额成功"),d.go("bankTicketLimitAmountMaintain")},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT?(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问")):$.messager.alert("提示","新增银票限额失败")})}},a.cancel=function(){d.go("bankTicketLimitAmountMaintain")}}]),FolController.controller("UpdateBankTicketLimitAmountMaintainController",["$scope","$timeout","$q","$state","$stateParams","BankTicketLimitAmountMaintainService",function(a,b,c,d,e,f){function g(){return 2==a.data.maintain&&$("#effectDate").datebox("getValue")<$("#expireDate").datebox("getValue")?!1:!0}a.data=e.data,b(function(){$("#amountLimit").textbox("setValue",a.data.vo.moneyDisplay),$("#effectDateDisplay").textbox("setValue",a.data.vo.effectDateDisplay),$("#auditStatusName").textbox("setValue",a.data.vo.auditStatusName),$("#auditMsg").textbox("setValue",a.data.vo.auditMsg),2==a.data.maintainType&&($("#dealerTypeName").textbox("setValue",a.data.vo.dealerTypeName),$("#sapCode").textbox("setValue",a.data.vo.sapCode),$("#brandName").textbox("setValue",a.data.vo.brandName),$("#dealerName").textbox("setValue",a.data.vo.dealerName),$("#expireDateDisplay").textbox("setValue",a.data.vo.expireDateDisplay))}),a.updateBankTicketLimitAmount=function(){if(g()){var b={amountLimit:$("#currentAmountLimit").numberbox("getValue"),effectDate:$("#effectDate").datebox("getValue"),encryptId:a.data.vo.encryptId};2==a.data.maintainType&&(b.expireDate=$("#expireDate").datebox("getValue")),f.updateBankTicketLimitAmount(b,"bankTicket/limitAmount/update",function(a){$.messager.alert("提示","修改银票限额成功"),d.go("bankTicketLimitAmountMaintain")},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT?(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问")):$.messager.alert("提示","修改银票限额失败")})}},a.cancel=function(){d.go("bankTicketLimitAmountMaintain")}}]),FolController.controller("BankTicketLimitMaintainController",["$scope","$timeout","$state","$q","BankTicketLimitMaintainService","CodeService",function(a,b,c,d,e,f){function g(a,c){$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),f.findCodeTypeNames(c,"code/findCodeTypeNames",function(c){$.messager.progress("close"),b(function(){for(var b=0;b<c.length;b++)if(!folUtil.isNull(c[b]))if("银票审核状态"==c[b][1].typeName){var d=[];$.each(c[b],function(a,b){b.codeCnDesc.indexOf("删除")<0&&d.push(b)}),$(a[b]).combobox("loadData",d),$(a[b]).combobox("select",d[0].code)}else if("维护类型"==c[b][1].typeName){var d=[];$.each(c[b],function(a,b){b.codeCnDesc.indexOf("请选择")<0&&d.push(b)}),$(a[b]).combobox("loadData",d),$(a[b]).combobox("select",d[0].code)}else $(a[b]).combobox("loadData",c[b]),$(a[b]).combobox("select",c[b][0].code)})},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}a.istableshow=!1,b(function(){if($("#datagridDealer").length>0){var b=$("#datagridDealer").datagrid("getPager");b.pagination({onSelectPage:function(b,c){a.query_data.beginNo=c*(b-1)==0?0:c*(b-1)+1,a.query_data.endNo=c*b,$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),e.query(a.query_data,"bankTictet/limits/query",function(a,b){$.messager.progress("close"),$("#datagridDealer").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}})}if($("#datagridBank").length>0){var b=$("#datagridBank").datagrid("getPager");b.pagination({onSelectPage:function(b,c){a.query_data.beginNo=c*(b-1)==0?0:c*(b-1)+1,a.query_data.endNo=c*b,$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),e.query(a.query_data,"bankTictet/limits/query",function(a,b){$.messager.progress("close"),$("#datagridBank").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}})}var c=["#dealerTypeFirst","#bankTicketAuditStatusFirst"],d=["渠道类型","银票审核状态"];g(c,d),a.query(1),a.selectedTable="dealer",$(".sgm_tabs").tabs({onSelect:function(b){if("银行渠道银票额度维护"==b){var c=["#dealerTypeFirst","#bankTicketAuditStatusFirst"],d=["渠道类型","银票审核状态"];g(c,d),a.query(1),a.selectedTable="dealer"}else{var c=["#bankTicketAuditStatusSecond"],d=["银票审核状态"];g(c,d),a.query(2),a.selectedTable="bank"}}})}),a.query=function(b){a.istableshow=!0,a.query_data={maintainType:b,beginNo:0,endNo:10},1==b?(a.query_data.dealerType=folUtil.getComboBoxDataById("dealerTypeFirst"),a.query_data.auditStatus=folUtil.getComboBoxDataById("bankTicketAuditStatusFirst")):a.query_data.auditStatus=folUtil.getComboBoxDataById("bankTicketAuditStatusSecond"),$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),e.query(a.query_data,"bankTictet/limits/query",function(a,c){$.messager.progress("close"),1==b?($("#datagridDealer").datagrid("loadData",{total:0,rows:[]}),$("#datagridDealer").datagrid("loadData",a)):($("#datagridBank").datagrid("loadData",{total:0,rows:[]}),$("#datagridBank").datagrid("loadData",a))},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})},a.insertDealer=function(){c.go("addBankTicketLimit",{data:{maintainType:1,type:"add",pageTitle:"新增银行银票额度"}})},a.insertBank=function(){c.go("addBankTicketLimit",{data:{maintainType:2,type:"add",pageTitle:"新增银行银票额度"}})},a.update=function(){var b;return b="dealer"==a.selectedTable?$("#datagridDealer").datagrid("getSelections"):$("#datagridBank").datagrid("getSelections"),b.length<=0?void $.messager.alert("提示","请选择某条记录在进行修改"):b.length>1?void $.messager.alert("提示","不能选择多条记录进行修改"):b[0].auditStatus==STATE.BANK_TICKET_ADD_UN_AUDIT||b[0].auditStatus==STATE.BANK_TICKET_UPDATE_UN_AUDIT||b[0].auditStatus==STATE.BANK_TICKET_DELETE_UN_AUDIT?void $.messager.alert("提示","当前状态是待审核不能给予修改"):void("dealer"==a.selectedTable?c.go("updateBankTicketLimit",{data:{bankBankTicketVo:b[0],maintainType:1,type:"update",pageTitle:"更新银行银票额度"}}):c.go("updateBankTicketLimit",{data:{bankBankTicketVo:b[0],maintainType:2,type:"update",pageTitle:"更新银行银票额度"}}))},a["import"]=function(){c.go("uploadFilePage",{pageName:"bankTicketLimitMaintain"})}}]),FolController.controller("AddBankTicketLimitController",["$scope","$timeout","$state","$q","$stateParams","BankTicketLimitMaintainService","CodeService",function(a,b,c,d,e,f,g){function h(){return folUtil.isNull(a.bankAbbr)?($.messager.alert("提示","银行简称不能为空"),!1):folUtil.isNull(a.bankCnDesc)?($.messager.alert("提示","银行中文名称不能为空"),!1):$("#dealerType").length>0&&(folUtil.isNull(folUtil.getComboBoxDataById("dealerType"))||-1==folUtil.getComboBoxDataById("dealerType"))?($.messager.alert("提示","渠道类型不能为空"),!1):folUtil.isNull(a.totalAmount)?($.messager.alert("提示","银票总额不能为空"),!1):!0}a.data=e.data,b(function(){$("#bankTicketLimit").panel({title:a.data.pageTitle});var c=["渠道类型"];$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),g.findCodeTypeNames(c,"code/findCodeTypeNames",function(a){$.messager.progress("close");var c=["#dealerType"];b(function(){for(var b=0;b<a.length;b++)folUtil.isNull(a[b])||($(c[b]).combobox("loadData",a[b]),$(c[b]).combobox("select",a[b][0].code))})},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}),a.addBankTicketLimit=function(){var b={dealerType:$("#dealerType").length>0?folUtil.getComboBoxDataById("dealerType"):null,bankAbbr:a.bankAbbr,bankChName:a.bankCnDesc,amount:a.totalAmount,bankEnName:a.bankEnDesc,maintainType:e.data.maintainType};h()&&f.addBankTicketLimit(b,"bankTictet/limits/add",function(a){$.messager.alert("提示","银行银票额度新增成功"),c.go("bankTicketLimitMaintain")},function(a){$.messager.alert("提示","银行银票新增失败")})}}]),FolController.controller("UpdateBankTicketLimitController",["$scope","$timeout","$state","$q","$stateParams","BankTicketLimitMaintainService","CodeService",function(a,b,c,d,e,f,g){a.data=e.data,b(function(){$("#bankTicketLimit").panel({title:a.data.pageTitle});var c=["渠道类型"];g.findCodeTypeNames(c,"code/findCodeTypeNames",function(a){$.messager.progress("close");var c=["#dealerType"];b(function(){for(var b=0;b<a.length;b++)folUtil.isNull(a[b])||$(c[b]).combobox("loadData",a[b])})},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))}),$("#dealerType").combobox("select",a.data.bankBankTicketVo.dealerType),$("#bankAbbr").textbox("setValue",a.data.bankBankTicketVo.bankAbbr),$("#bankCnDesc").textbox("setValue",a.data.bankBankTicketVo.bankChName),$("#totalAmount").numberbox("setValue",a.data.bankBankTicketVo.moneyDisplay),$("#bankEnDesc").textbox("setValue",a.data.bankBankTicketVo.bankEnName)}),a.updateBankTicketLimit=function(){console.log(a.data.bankBankTicketVo.bankId);var b={dealerType:$("#dealerType").length>0?folUtil.getComboBoxDataById("dealerType"):null,bankAbbr:a.bankAbbr,bankChName:a.bankCnDesc,amount:a.totalAmount,bankEnName:a.bankEnDesc,bankId:a.data.bankBankTicketVo.bankId,encryptId:a.data.bankBankTicketVo.encryptId};f.updateBankTicketLimit(b,"bankTictet/limits/update",function(a){$.messager.alert("提示","银行银票额度更新成功"),c.go("bankTicketLimitMaintain")},function(a){$.messager.alert("提示","银行银票额度更新失败"),console.log(a)})}}]),FolController.controller("TicketInterestRateMaintainController",["$scope","$timeout","$state","$q","TicketInterestRateMaintainService",function(a,b,c,d,e){b(function(){if($("#datagrid").datagrid().datagrid("enableCellEditing"),$("#datagridHis").datagrid().datagrid("enableCellEditing"),$("#datagrid").length>0){var b=$("#datagrid").datagrid("getPager");b.pagination({onSelectPage:function(b,c){a.query_data.beginNo=c*(b-1)==0?0:c*(b-1)+1,a.query_data.endNo=c*b,$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),e.queryCur(a.query_data,"interestRate/maintain/queryCur",function(a,b){$.messager.progress("close"),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}})}if($("#datagridHis").length>0){var b=$("#datagridHis").datagrid("getPager");b.pagination({onSelectPage:function(b,c){a.query_data.beginNo=c*(b-1)==0?0:c*(b-1)+1,a.query_data.endNo=c*b,$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),e.queryHis(a.query_data,"interestRate/maintain/queryHis",function(a,b){$.messager.progress("close"),$("#datagridHis").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}})}}),a.query_data={auditStatus:a.auditStatus,beginNo:0,endNo:10},e.queryCur(a.query_data,"interestRate/maintain/queryCur",function(a,b){$.messager.progress("close"),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))}),e.queryHis(a.query_data,"interestRate/maintain/queryHis",function(a,b){$.messager.progress("close"),$("#datagridHis").datagrid("loadData",{total:0,rows:[]}),$("#datagridHis").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))}),a.update=function(){var a;return a=$("#datagrid").datagrid("getSelections"),a.length<=0?void $.messager.alert("提示","请选择最新一条记录进行修改"):a.length>1?void $.messager.alert("提示","不能选择多条记录进行修改"):null!=a[0].unAuditRateCur?void $.messager.alert("提示","当前状态是待审核不能给予修改"):void c.go("updateInterestRateHis")}}]),FolController.controller("UpdateInterestRateController",["$scope","$timeout","$state","$q","TicketInterestRateMaintainService","CodeService",function(a,b,c,d,e,f){a.confirm=function(){var a={annualInterestRate:$("#annualInterestRate").textbox("getValue")};e.checkdata(a,"interestRate/maintain/getSign",function(a,b){console.log(a),e.confirm(a,"interestRate/maintain/update",function(a,b){$.messager.alert("提示","修改成功"),c.go("ticketInterestRateMaintain")},function(a){a.state===STATE.TIMEOUT?(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问")):$.messager.alert("提示","修改失败")})},function(a){a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})},a.cancel=function(){c.go("ticketInterestRateMaintain")}}]),FolController.controller("BankBankTicketLimitVerifyControllor",["$scope","$timeout","$state","$q","BankBankTicketLimitVerifyService","CodeService",function(a,b,c,d,e,f){a.istableshow=!1,b(function(){if($("#datagrid").datagrid().datagrid("enableCellEditing"),$("#datagrid").length>0){var b=$("#datagrid").datagrid("getPager");b.pagination({onSelectPage:function(b,c){a.query_data.beginNo=c*(b-1)==0?0:c*(b-1)+1,a.query_data.endNo=c*b,$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),e.query(a.query_data,"bankBankTicketVerify/limits/query",function(a,b){$.messager.progress("close"),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}}),$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),a.query_data={auditStatus:a.auditStatus,beginNo:0,endNo:10},e.query(a.query_data,"bankBankTicketVerify/limits/query",function(a,b){$.messager.progress("close"),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}}),a.auditSuccess=function(){var b=$("#datagrid").datagrid("getChecked");if(b.length<=0)return void $.messager.alert("提示","请选择至少一条记录，再进行操作");var c=[];$.each(b,function(a,b){c.push({encryptId:b.encryptId,auditMsg:b.auditMsg,moneyDisplay:b.amount,auditStatus:b.auditStatus})}),$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),e.auditSuccess(c,"bankBankTicketVerify/limits/auditSuccess",function(b,c){$.messager.progress("close"),$.messager.alert("提示","审批成功"),e.query(a.query_data,"bankBankTicketVerify/limits/query",function(a,b){$.messager.progress("close"),$("#datagrid").datagrid("loadData",{total:0,rows:[]}),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})},function(a){return $.messager.progress("close"),a.state===STATE.TIMEOUT?(console.log("timeout"),void $.messager.alert("提示","系统超时请稍后访问")):void $.messager.alert("提示","审核失败请检查原因")})},a.reject=function(){var b=$("#datagrid").datagrid("getChecked");if(b.length<=0)return void $.messager.alert("提示","请选择至少一条记录，再进行操作");var c=[];$.each(b,function(a,b){c.push({encryptId:b.encryptId,auditMsg:b.auditMsg,moneyDisplay:b.amount,auditStatus:b.auditStatus})}),$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),e.reject(c,"bankBankTicketVerify/limits/reject",function(b,c){$.messager.alert("提示","驳回成功"),e.query(a.query_data,"bankBankTicketVerify/limits/query",function(a,b){$.messager.progress("close"),$("#datagrid").datagrid("loadData",{total:0,rows:[]}),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})},function(a){return $.messager.progress("close"),a.state===STATE.TIMEOUT?(console.log("timeout"),void $.messager.alert("提示","系统超时请稍后访问")):void $.messager.alert("提示","驳回失败请检查原因")})}}]),FolController.controller("BankSpecialDealerVerifyControllor",["$scope","$timeout","$state","$q","BankSpecialDealerVerifyService","CodeService",function(a,b,c,d,e,f){b(function(){if($("#datagrid").length>0){var c=$("#datagrid").datagrid("getPager");c.pagination({onSelectPage:function(b,c){a.query_data.beginNo=c*(b-1)==0?0:c*(b-1)+1,a.query_data.endNo=c*b,$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),e.query(a.query_data,"bankTicketVerify/specialDealer/querySpecialDealer",function(a,b){$.messager.progress("close"),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}})}var d=["渠道类型","品牌"];f.findCodeTypeNames(d,"code/findCodeTypeNames",function(a){$.messager.progress("close");var c=["#dealerType","#brand"];b(function(){for(var b=0;b<a.length;b++)folUtil.isNull(a[b])||($(c[b]).combobox("loadData",a[b]),$(c[b]).combobox("select",a[b][0].code))})},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}),a.query=function(){a.istableshow=!0,a.query_data={dealerType:folUtil.getComboBoxDataById("dealerType"),sapCode:$("#sapCode").textbox("getValue"),dealerName:$("#dealerName").textbox("getValue"),brand:folUtil.getComboBoxDataById("brand"),beginNo:0,endNo:10},$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),e.query(a.query_data,"bankTicketVerify/specialDealer/querySpecialDealer",function(a,b){$("#datagrid").datagrid().datagrid("enableCellEditing"),$.messager.progress("close"),$("#datagrid").datagrid("loadData",{total:0,rows:[]}),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})},a.auditSuccess=function(){var b=$("#datagrid").datagrid("getChecked");return b.length<=0?void $.messager.alert("提示","请选择至少一条记录，再进行操作"):($.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),void e.auditSuccess(b,"bankTicketVerify/specialDealer/auditSuccess",function(b,c){$.messager.progress("close"),$.messager.alert("提示","审批成功"),e.query(a.query_data,"bankTicketVerify/specialDealer/querySpecialDealer",function(a,b){$("#datagrid").datagrid("loadData",{total:0,rows:[]}),$("#datagrid").datagrid("loadData",a)},function(a){a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})},function(a){$.messager.progress("close"),$.messager.alert("提示","审核失败请检查原因")}))},a.reject=function(){var b=d.defer(),c=(b.promise,$("#datagrid").datagrid("getChecked"));return c.length<=0?void $.messager.alert("提示","请选择至少一条记录，再进行操作"):($.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),void e.reject(c,"bankTicketVerify/specialDealer/reject",function(b,c){$.messager.progress("close"),$.messager.alert("提示","驳回成功"),e.query(a.query_data,"bankTicketVerify/specialDealer/querySpecialDealer",function(a,b){$("#datagrid").datagrid("loadData",{total:0,rows:[]}),$("#datagrid").datagrid("loadData",a)},function(a){a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))}),$("#datagrid").datagrid("getSelections",b)},function(a){$.messager.progress("close"),$.messager.alert("提示","驳回失败请检查原因")}))}}]),FolController.controller("BankTicketDeadLineVerifyControllor",["$scope","$timeout","$state","$q","$stateParams","BankTicketDeadLineVerifyService","CodeService",function(a,b,c,d,e,f,g){var h="brand";b(function(){if($("#branddatagrid").datagrid().datagrid("enableCellEditing"),$("#specialdealerdatagrid").datagrid().datagrid("enableCellEditing"),$("#branddatagrid").length>0){var c=$("#branddatagrid").datagrid("getPager");c.pagination({onSelectPage:function(b,c){a.brand_query_data.beginNo=c*(b-1)==0?0:c*(b-1)+1,a.brand_query_data.endNo=c*b,$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),f.query(a.brand_query_data,"bankTicketVerify/deadLine/queryBrand",function(a,b){$.messager.progress("close"),$("#branddatagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}}),a.brand_query_data={auditStatus:a.auditStatus,beginNo:0,endNo:10},f.query(a.brand_query_data,"bankTicketVerify/deadLine/queryBrand",function(a,b){$.messager.progress("close"),$("#branddatagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}if($("#specialdealerdatagrid").length>0){var c=$("#specialdealerdatagrid").datagrid("getPager");c.pagination({onSelectPage:function(b,c){a.specialdealer_query_data.beginNo=c*(b-1)==0?0:c*(b-1)+1,a.specialdealer_query_data.endNo=c*b,$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),f.query(a.specialdealer_query_data,"bankTicketVerify/deadLine/querySpecialDealer",function(a,b){$.messager.progress("close"),$("#specialdealerdatagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}})}$(".sgm_tabs").tabs({onSelect:function(c){if("审核特殊经销商"==c){h="specialDealer",$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT});var d=["渠道类型","品牌"];g.findCodeTypeNames(d,"code/findCodeTypeNames",function(a){$.messager.progress("close");var c=["#dealerType","#brand"];b(function(){for(var b=0;b<a.length;b++)folUtil.isNull(a[b])||($(c[b]).combobox("loadData",a[b]),$(c[b]).combobox("select",a[b][0].code))})},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))}),a.specialdealer_query_data={dealerType:folUtil.getComboBoxDataById("dealerType"),sapCode:$("#sapCode").textbox("getValue"),dealerName:$("#dealerName").textbox("getValue"),brandId:folUtil.getComboBoxDataById("brand"),beginNo:0,endNo:10},f.query(a.specialdealer_query_data,"bankTicketVerify/deadLine/querySpecialDealer",function(a,b){$("#specialdealerdatagrid").datagrid("loadData",{total:0,rows:[]}),$("#specialdealerdatagrid").datagrid("loadData",a)},function(a){a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}else h="brand",a.brand_query_data={beginNo:0,endNo:10},$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),f.query(a.brand_query_data,"bankTicketVerify/deadLine/queryBrand",function(a,b){$.messager.progress("close"),$("#branddatagrid").datagrid("loadData",{total:0,rows:[]}),$("#branddatagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}})}),a.auditSuccessBrand=function(){var b=$("#branddatagrid").datagrid("getChecked");return b.length<=0?void $.messager.alert("提示","请选择至少选择一条记录，再进行操作"):($.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),void f.auditSuccess(b,"bankTicketVerify/deadLine/auditSuccess",function(b,c){$.messager.progress("close"),$.messager.alert("提示","审批成功"),f.query(a.brand_query_data,"bankTicketVerify/deadLine/queryBrand",function(a,b){$.messager.progress("close"),$("#branddatagrid").datagrid("loadData",{total:0,rows:[]}),$("#branddatagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})},function(a){$.messager.progress("close"),$.messager.alert("提示","审核失败请检查原因")}))},a.rejectBrand=function(){var b=$("#branddatagrid").datagrid("getChecked");return b.length<=0?void $.messager.alert("提示","请选择至少一条记录，再进行操作"):($.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),void f.reject(b,"bankTicketVerify/deadLine/reject",function(b,c){$.messager.alert("提示","驳回成功"),f.query(a.brand_query_data,"bankTicketVerify/deadLine/queryBrand",function(a,b){$.messager.progress("close"),$("#branddatagrid").datagrid("loadData",{total:0,rows:[]}),$("#branddatagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})},function(a){$.messager.progress("close"),$.messager.alert("提示","驳回失败请检查原因")}))},a.query=function(){a.istableshow=!0,a.brand_query_data={dealerType:folUtil.getComboBoxDataById("dealerType"),sapCode:$("#sapCode").textbox("getValue"),dealerName:$("#dealerName").textbox("getValue"),brandId:folUtil.getComboBoxDataById("brand"),beginNo:0,endNo:10},$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),f.query(a.brand_query_data,"bankTicketVerify/deadLine/querySpecialDealer",function(a,b){$.messager.progress("close"),$("#specialdealerdatagrid").datagrid("loadData",{total:0,rows:[]}),$("#specialdealerdatagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})},a.auditSuccess=function(){var b=$("#specialdealerdatagrid").datagrid("getChecked");return b.length<=0?void $.messager.alert("提示","请选择至少一条记录，再进行操作"):($.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),void f.auditSuccess(b,"bankTicketVerify/deadLine/auditSuccess",function(b,c){$.messager.progress("close"),$.messager.alert("提示","审批成功"),f.query(a.specialdealer_query_data,"bankTicketVerify/deadLine/querySpecialDealer",function(a,b){$("#specialdealerdatagrid").datagrid("loadData",{total:0,rows:[]}),$("#specialdealerdatagrid").datagrid("loadData",a)},function(a){a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})},function(a){$.messager.progress("close"),$.messager.alert("提示","审核失败请检查原因")}))},a.reject=function(){var b=$("#specialdealerdatagrid").datagrid("getChecked");return b.length<=0?void $.messager.alert("提示","请选择至少一条记录，再进行操作"):($.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),void f.reject(b,"bankTicketVerify/deadLine/reject",function(b,c){$.messager.progress("close"),$.messager.alert("提示","驳回成功"),f.query(a.specialdealer_query_data,"bankTicketVerify/deadLine/querySpecialDealer",function(a,b){$("#specialdealerdatagrid").datagrid("loadData",{total:0,rows:[]}),$("#specialdealerdatagrid").datagrid("loadData",a)},function(a){a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})},function(a){$.messager.progress("close"),$.messager.alert("提示","驳回失败请检查原因")}))}}]),FolController.controller("BankTicketLimitVerifyControllor",["$scope","$timeout","$state","$q","BankTicketLimitService","CodeService",function(a,b,c,d,e,f){var g="brand";b(function(){if($("#branddatagrid").datagrid().datagrid("enableCellEditing"),$("#specialdealerdatagrid").datagrid().datagrid("enableCellEditing"),$("#branddatagrid").length>0){var c=$("#branddatagrid").datagrid("getPager");c.pagination({onSelectPage:function(b,c){a.query_data.beginNo=c*(b-1)==0?0:c*(b-1)+1,a.query_data.endNo=c*b,$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),e.query(a.query_data,"bankTicketLimitAmountVerify/limits/queryBrand",function(a,b){$.messager.progress("close"),$("#branddatagrid").datagrid("loadData",a)},function(a,b){$.messager.progress("close"),b.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问")),console.log("error:"+a)})}}),a.query_data={auditStatus:a.auditStatus,beginNo:0,endNo:10},$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),e.query(a.query_data,"bankTicketLimitAmountVerify/limits/queryBrand",function(a,b){$.messager.progress("close"),$("#branddatagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}if($("#specialdealerdatagrid").length>0){var c=$("#specialdealerdatagrid").datagrid("getPager");c.pagination({onSelectPage:function(b,c){a.query_data.beginNo=c*(b-1)==0?0:c*(b-1)+1,a.query_data.endNo=c*b,$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),e.query(a.query_data,"bankTicketLimitAmountVerify/limits/querySpecialDealer",function(a,b){$.messager.progress("close"),$("#specialdealerdatagrid").datagrid("loadData",a)},function(a,b){$.messager.progress("close"),b.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问")),console.log("error:"+a)})}})}$(".sgm_tabs").tabs({onSelect:function(c){if("审核特殊经销商"==c){g="specialDealer",$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT});var d=["渠道类型","品牌"];f.findCodeTypeNames(d,"code/findCodeTypeNames",function(a){$.messager.progress("close");var c=["#dealerType","#brand"];b(function(){for(var b=0;b<a.length;b++)folUtil.isNull(a[b])||($(c[b]).combobox("loadData",a[b]),$(c[b]).combobox("select",a[b][0].code))})},function(a,b){$.messager.progress("close"),b.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问")),console.log("error:"+a)}),e.query(a.query_data,"bankTicketLimitAmountVerify/limits/querySpecialDealer",function(a,b){$.messager.progress("close"),$("#specialdealerdatagrid").datagrid("loadData",{total:0,rows:[]}),$("#specialdealerdatagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}else g="brand",$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),a.query_data={beginNo:0,endNo:10},e.query(a.query_data,"bankTicketLimitAmountVerify/limits/queryBrand",function(a,b){$.messager.progress("close"),$("#branddatagrid").datagrid("loadData",{total:0,rows:[]}),$("#branddatagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}})}),a.auditSuccessBrand=function(){var b=$("#branddatagrid").datagrid("getChecked");return b.length<=0?void $.messager.alert("提示","请选择至少一条记录，再进行操作"):($.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),void e.auditSuccess(b,"bankTicketLimitAmountVerify/limits/auditSuccess",function(b,c){$.messager.progress("close"),$.messager.alert("提示","审核成功"),e.query(a.query_data,"bankTicketLimitAmountVerify/limits/queryBrand",function(a,b){$.messager.progress("close"),$("#branddatagrid").datagrid("loadData",{total:0,rows:[]}),$("#branddatagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})},function(a){$.messager.progress("close"),$.messager.alert("提示","审核失败请检查原因")}))},a.rejectBrand=function(){var b=$("#branddatagrid").datagrid("getChecked");return b.length<=0?void $.messager.alert("提示","请选择至少一条记录，再进行操作"):($.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT
}),void e.reject(b,"bankTicketLimitAmountVerify/limits/reject",function(b,c){$.messager.progress("close"),$.messager.alert("提示","驳回成功"),e.query(a.query_data,"bankTicketLimitAmountVerify/limits/queryBrand",function(a,b){$.messager.progress("close"),$("#branddatagrid").datagrid("loadData",{total:0,rows:[]}),$("#branddatagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})},function(a){$.messager.progress("close"),$.messager.alert("提示","驳回失败请检查原因")}))},a.find=function(){a.istableshow=!0,a.query_data={dealerType:folUtil.getComboBoxDataById("dealerType"),sapCode:$("#sapCode").textbox("getValue"),dealerName:$("#dealerName").textbox("getValue"),brandId:folUtil.getComboBoxDataById("brand"),beginNo:0,endNo:10},$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),e.query(a.query_data,"bankTicketLimitAmountVerify/limits/querySpecialDealer",function(a,b){$.messager.progress("close"),$("#specialdealerdatagrid").datagrid("loadData",{total:0,rows:[]}),$("#specialdealerdatagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})},a.auditSuccess=function(){var b=$("#specialdealerdatagrid").datagrid("getChecked");return b.length<=0?void $.messager.alert("提示","请选择至少一条记录，再进行操作"):($.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),void e.auditSuccess(b,"bankTicketLimitAmountVerify/limits/auditSuccess",function(b,c){$.messager.progress("close"),$.messager.alert("提示","审核成功"),e.query(a.query_data,"bankTicketLimitAmountVerify/limits/querySpecialDealer",function(a,b){$.messager.progress("close"),$("#specialdealerdatagrid").datagrid("loadData",{total:0,rows:[]}),$("#specialdealerdatagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})},function(a){$.messager.progress("close"),$.messager.alert("提示","审核失败请检查原因")}))},a.reject=function(){var b=$("#specialdealerdatagrid").datagrid("getChecked");return b.length<=0?void $.messager.alert("提示","请选择至少一条记录，再进行操作"):($.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),void e.reject(b,"bankTicketLimitAmountVerify/limits/reject",function(b,c){$.messager.progress("close"),$.messager.alert("提示","驳回成功"),e.query(a.query_data,"bankTicketLimitAmountVerify/limits/querySpecialDealer",function(a,b){$.messager.progress("close"),$("#specialdealerdatagrid").datagrid("loadData",{total:0,rows:[]}),$("#specialdealerdatagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})},function(a){$.messager.progress("close"),$.messager.alert("提示","驳回失败请检查原因")}))}}]),FolController.controller("TicketInterestRateAuditController",["$scope","$timeout","$state","$q","TicketInterestRateAuditService",function(a,b,c,d,e){a.istableshow=!1,b(function(){if($("#datagrid").datagrid().datagrid("enableCellEditing"),$("#datagrid").length>0){var b=$("#datagrid").datagrid("getPager");b.pagination({onSelectPage:function(b,c){a.query_data.beginNo=c*(b-1)==0?0:c*(b-1)+1,a.query_data.endNo=c*b,$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),e.query(a.query_data,"interestRate/audit/query",function(a,b){$.messager.progress("close"),$("#datagrid").datagrid("loadData",{total:0,rows:[]}),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}}),$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),a.query_data={auditStatus:a.auditStatus,beginNo:0,endNo:10},e.query(a.query_data,"interestRate/audit/query",function(a,b){$.messager.progress("close"),$("#datagrid").datagrid("loadData",{total:0,rows:[]}),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}}),a.auditSuccess=function(){var b=$("#datagrid").datagrid("getChecked");if(b.length<=0)return void $.messager.alert("提示","请选择至少一条记录，再进行操作");var c=[];$.each(b,function(a,b){c.push({auditMsg:b.auditMsg,auditStatus:b.auditStatus})}),$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),a.query_data={auditStatus:a.auditStatus,beginNo:0,endNo:10},e.auditSuccess(c,"interestRate/audit/auditSuccess",function(b,c){$.messager.alert("提示","审批成功"),e.query(a.query_data,"interestRate/audit/query",function(a,b){$.messager.progress("close"),$("#datagrid").datagrid("loadData",{total:0,rows:[]}),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})},function(a){return $.messager.progress("close"),a.state===STATE.TIMEOUT?(console.log("timeout"),void $.messager.alert("提示","系统超时请稍后访问")):void $.messager.alert("提示","审核失败请检查原因")})},a.reject=function(){var b=$("#datagrid").datagrid("getChecked");if(b.length<=0)return void $.messager.alert("提示","请选择至少一条记录，再进行操作");var c=[];$.each(b,function(a,b){c.push({encryptId:b.encryptId,auditMsg:b.auditMsg,moneyDisplay:b.amount,auditStatus:b.auditStatus})}),$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),a.query_data={auditStatus:a.auditStatus,beginNo:0,endNo:10},e.reject(c,"interestRate/audit/reject",function(b,c){$.messager.alert("提示","驳回成功"),e.query(a.query_data,"interestRate/audit/query",function(a,b){$.messager.progress("close"),$("#datagrid").datagrid("loadData",{total:0,rows:[]}),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})},function(a){return $.messager.progress("close"),a.state===STATE.TIMEOUT?(console.log("timeout"),void $.messager.alert("提示","系统超时请稍后访问")):void $.messager.alert("提示","驳回失败请检查原因")})}}]),FolController.controller("BankTicketCollectController",["$scope","$timeout","$q","$state","BankTicketDeatilService","BankInfoService","CodeService",function(a,b,c,d,e,f,g){a.istableshow=!1,b(function(){if($("#datagrid").length>0){var c=$("#datagrid").datagrid("getPager");c.pagination({onSelectPage:function(b,c){a.query_data.beginNo=c*(b-1)==0?0:c*(b-1)+1,a.query_data.endNo=c*b,$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),e.query(a.query_data,"bankTicket/collect/query",function(a,b){$.messager.progress("close"),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}})}$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),f.findAll("bankTicket/bankInfo/findAll",function(a,c){if($.messager.progress("close"),!folUtil.isNull(a)){var d=[];d.push({bankAbbr:"-1",bankChName:"请选择"}),$.each(a.rows,function(a,b){d.push(b)}),console.log(a),console.log(d),b(function(){$("#bankId").combobox("loadData",d),$("#bankId").combobox("select",d[0].bankAbbr)})}},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))}),$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT});var d=["渠道类型"];g.findCodeTypeNames(d,"code/findCodeTypeNames",function(a){$.messager.progress("close");var c=["#dealerType"];b(function(){for(var b=0;b<a.length;b++)folUtil.isNull(a[b])||($(c[b]).combobox("loadData",a[b]),$(c[b]).combobox("select",a[b][0].code))})},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}),a.query=function(){a.istableshow=!0,a.query_data={dealerType:folUtil.getComboBoxDataById("dealerType"),bankId:folUtil.getComboBoxDataById("bankId"),beginNo:0,endNo:10},$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),e.query(a.query_data,"bankTicket/collect/query",function(a,b){$.messager.progress("close"),$("#datagrid").datagrid("loadData",{total:0,rows:[]}),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}}]),FolController.controller("BankTicketDeatilController",["$scope","$timeout","$q","$state","BankTicketDeatilService","BankInfoService","CodeService",function(a,b,c,d,e,f,g){a.istableshow=!1,b(function(){if($("#datagrid").length>0){var c=$("#datagrid").datagrid("getPager");c.pagination({onSelectPage:function(b,c){a.query_data.beginNo=c*(b-1)==0?0:c*(b-1)+1,a.query_data.endNo=c*b,$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),e.query(a.query_data,"bankTicket/deatil/query",function(a,b){$.messager.progress("close"),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}})}$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),f.findAll("bankTicket/bankInfo/findAll",function(a,c){if($.messager.progress("close"),!folUtil.isNull(a)){var d=[];d.push({bankAbbr:"-1",bankChName:"请选择"}),$.each(a.rows,function(a,b){d.push(b)}),b(function(){$("#bankId").combobox("loadData",d),$("#bankId").combobox("select",d[0].bankAbbr)})}},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))});var d=[];d.push({value:"-1",displayName:"请选择"}),d.push({value:"0",displayName:"银票已到期"}),d.push({value:"1",displayName:"银票未到期"}),d.push({value:"2",displayName:"银票已背书"}),d.push({value:"3",displayName:"银票已贴现"}),b(function(){$("#bankTicketStatus").combobox("loadData",d),$("#bankTicketStatus").combobox("select",d[0].value)});var h=["渠道类型","品牌"];g.findCodeTypeNames(h,"code/findCodeTypeNames",function(a){$.messager.progress("close");var c=["#dealerType","#brandId"];b(function(){for(var b=0;b<a.length;b++)folUtil.isNull(a[b])||($(c[b]).combobox("loadData",a[b]),$(c[b]).combobox("select",a[b][0].code))})},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}),a.query=function(){a.istableshow=!0,a.query_data={dealerType:folUtil.getComboBoxDataById("dealerType"),brandId:folUtil.getComboBoxDataById("brandId"),bankId:folUtil.getComboBoxDataById("bankId"),sapCode:$("#sapCode").textbox("getValue"),dealerName:$("#dealerName").textbox("getValue"),documentNumber:$("#documentNumber").textbox("getValue"),acceptanceNumber:$("#acceptanceNumber").textbox("getValue"),issueDate:$("#issueDate").datebox("getValue"),expirationDate:$("#expirationDate").datebox("getValue"),bankTicketStatus:folUtil.getComboBoxDataById("bankTicketStatus"),beginNo:0,endNo:10},$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),e.query(a.query_data,"bankTicket/deatil/query",function(a,b){$.messager.progress("close"),$("#datagrid").datagrid("loadData",{total:0,rows:[]}),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}}]),FolController.controller("BankTicketInterestController",["$scope","$timeout","$q","$state","BankTicketInterestService","BankInfoService",function(a,b,c,d,e,f){function g(){b(function(){if($("#datagrid").length>0){var b=$("#datagrid").datagrid("getPager");b.pagination({onSelectPage:function(b,c){a.query_data.beginNo=c*(b-1)==0?0:c*(b-1)+1,a.query_data.endNo=c*b,$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),e.query(a.query_data,"bankTicket/bankTicketInterest/query",function(a,b){$.messager.progress("close"),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问")),console.log("error:"+a)})}})}},PROGRESS_ACTION_TIMEOUT)}function h(){return $("#startIssueDate").datebox("getValue")>$("#endIssueDate").datebox("getValue")?($.messager.alert("提示","起始开票日期不能大于结束开票日期"),!1):!0}a.istableshow=!1,b(function(){$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),f.findAll("bankTicket/bankInfo/findAll",function(a,c){if($.messager.progress("close"),!folUtil.isNull(a)){var d=[];d.push({bankAbbr:"-1",bankChName:"请选择"}),$.each(a.rows,function(a,b){d.push(b)}),b(function(){$("#bankId").combobox("loadData",d),$("#bankId").combobox("select",d[0].bankAbbr)})}},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))});var a=[];a.push({value:"-1",displayName:"请选择"}),a.push({value:"0",displayName:"无"}),a.push({value:"1",displayName:"有"}),b(function(){$("#documentNumberExists").combobox("loadData",a),$("#documentNumberExists").combobox("select",a[0].value)})}),a.query=function(){g(),a.istableshow=!0,a.query_data={sapCode:$("#sapCode").textbox("getValue"),bankId:folUtil.getComboBoxDataById("bankId"),acceptanceNumber:$("#acceptanceNumber").textbox("getValue"),documentNumberExists:folUtil.getComboBoxDataById("documentNumberExists"),startIssueDate:$("#startIssueDate").datebox("getValue"),endIssueDate:$("#endIssueDate").datebox("getValue"),beginNo:0,endNo:10},h()&&($.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),e.query(a.query_data,"bankTicket/bankTicketInterest/query",function(a,b){$.messager.progress("close"),$("#datagrid").datagrid("loadData",{total:0,rows:[]}),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问")),console.log("error:"+a)}))}}]),FolController.controller("BankTicketInterestDeatilCtrl",["$scope","$rootScope","$timeout","$q","$state","BankTicketInterestDeatilService",function(a,b,c,d,e,f){a.istableshow=!1,c(function(){if($("#interestDatagrid").length>0){var b=$("#interestDatagrid").datagrid("getPager");b.pagination({onSelectPage:function(b,c){a.query_data.beginNo=c*(b-1)==0?0:c*(b-1)+1,a.query_data.endNo=c*b,$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),f.query(a.query_data,"bankTicket/interestDeatil/query",function(a,b){$.messager.progress("close"),$("#interestDatagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}})}}),a.query=function(){$("#interestDataTable").attr("class","row-fluid ng-show"),a.istableshow=!0,a.query_data={acceptanceNumber:$("#acceptanceNumber").textbox("getValue"),documentNumber:$("#documentNumber").textbox("getValue"),startIssueDate:$("#startIssueDate").datebox("getValue"),endIssueDate:$("#endIssueDate").datebox("getValue"),startExpirationDate:$("#startExpirationDate").datebox("getValue"),endExpirationDate:$("#endExpirationDate").datebox("getValue"),sapCode:b.bankticket_interest_deatil_data.sapCode,year:b.bankticket_interest_deatil_data.year,month:b.bankticket_interest_deatil_data.month,beginNo:0,endNo:10},$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),f.query(a.query_data,"bankTicket/interestDeatil/query",function(a,b){$.messager.progress("close"),$("#interestDatagrid").datagrid("loadData",{total:0,rows:[]}),$("#interestDatagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}}]),FolController.controller("BankTicketInterestInventoryController",["$scope","$rootScope","$timeout","$q","$state","$window","BankTicketInterestInventoryService",function(a,b,c,d,e,f,g){a.istableshow=!1,c(function(){if(folUtil.setComboBoxYearDataById("year"),folUtil.setComboBoxMonthDataById("month"),$("#datagrid").length>0){var b=$("#datagrid").datagrid("getPager");b.pagination({onSelectPage:function(b,c){a.query_data.beginNo=c*(b-1)==0?0:c*(b-1)+1,a.query_data.endNo=c*b,$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),g.query(a.query_data,"bankTicket/businessInquiries/query",function(a,b){$.messager.progress("close"),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}}),$("#interestDeatilWindow").panel({onBeforeOpen:function(){$("#interestDataTable").attr("class","row-fluid ng-hide")}})}}),a.query=function(){a.istableshow=!0,a.query_data={year:folUtil.getComboBoxDataById("year"),month:folUtil.convertMonthToTwoPoint(folUtil.getComboBoxDataById("month")),sapCode:$("#sapCode").textbox("getValue"),beginNo:0,endNo:10},$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),g.query(a.query_data,"bankTicket/businessInquiries/query",function(a,b){$.messager.progress("close"),$("#datagrid").datagrid("loadData",{total:0,rows:[]}),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})},a.exportFile=function(){return folUtil.isNull(a.query_data)?void $.messager.alert("提示","请先查询一次再进行操作"):($.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),void g.getToken("services/tokens",function(b){$.messager.progress("close");var c="bankTicket/businessInquiries/exportInterestAmount?year="+a.query_data.year+"&month="+a.query_data.month+"&token="+b.token;console.log(c),f.open(c)},function(a){$.messager.progress("close"),console.log(a)}))},a.importFile=function(){e.go("uploadFilePage",{pageName:"bankTicketInterest"})},a.BankTicketInterestInventoryUpload=function(){var a=$("#datagrid").datagrid("getSelections");a.length<=0?$.messager.alert("提示","选择一条记录，再操作"):a.length>1?$.messager.alert("提示","只能一条记录，再操作"):g.InterestInventoryUpload(a[0],"bankTicket/businessInquiries/sendInterestAmount",function(a,b){console.log("suceess")},function(a){console.log("fail")})},a.issue=function(){var b=$("#datagrid").datagrid("getChecked");if(b.length<=0)return void $.messager.alert("提示","选择一条记录，再操作");for(var c="",d=0;d<b.length;d++){if(b[d].issueStatus==STATE.SUCCESS_BANK_TICKET_ISSUE)return void $.messager.alert("提示","你选择的第"+(d+1)+"行记录已发布过不能再次发布");c+=b[d].id+","}g.issue({ids:c},"bankTicket/businessInquiries/issue",function(b){$.messager.alert("提示","发布成功"),g.query(a.query_data,"bankTicket/businessInquiries/query",function(a,b){$("#datagrid").datagrid("loadData",{total:0,rows:[]}),$("#datagrid").datagrid("loadData",a)},function(a){a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})},function(a){$.messager.alert("提示","发布失败")})},a.bankTicketInterestDeatil=function(){var a=$("#datagrid").datagrid("getChecked");return a.length<=0?void $.messager.alert("提示","选择一条记录，再操作"):a.length>1?void $.messager.alert("提示","只能一条记录，再操作"):(a[0].year=folUtil.getComboBoxDataById("year"),a[0].month=folUtil.getComboBoxDataById("month"),b.bankticket_interest_deatil_data=a[0],void $("#interestDeatilWindow").window("open"))}}]),FolController.controller("BankTicketExceptionInventoryController",["$scope","$timeout","$window","BankTicketExceptionInventoryService",function(a,b,c,d){a.istableshow=!1,b(function(){if($("#datagrid").length>0){var b=$("#datagrid").datagrid("getPager");b.pagination({onSelectPage:function(b,c){a.query_data.beginNo=c*(b-1)==0?0:c*(b-1)+1,a.query_data.endNo=c*b,$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),d.query(a.query_data,"bankticket/exception/inventory",function(a,b){$.messager.progress("close"),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}})}}),a.query=function(){a.istableshow=!0,a.query_data={sapCode:$("#sapCode").textbox("getValue"),acceptanceNumber:$("#acceptanceNumber").textbox("getValue"),beginNo:0,endNo:10},$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),d.query(a.query_data,"bankticket/exception/inventory",function(a,b){$.messager.progress("close"),$("#datagrid").datagrid("loadData",{rows:[],total:0}),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})},a.exportFile=function(){return folUtil.isNull(a.query_data)?void $.messager.alert("提示","请先查询一次再导出"):($.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),void d.getToken("services/tokens",function(b){$.messager.progress("close"),c.open("bankticket/exception/exportQueryResult?sapCode="+a.query_data.sapCode+"&acceptanceNumber="+a.query_data.acceptanceNumber+"&token="+b.token)},function(a){$.messager.progress("close"),console.log(a)}))}}]),FolController.controller("bonusAmountReconcileCtrl",["$scope","$rootScope","$timeout","BonusService","$window",function(a,b,c,d,e){function f(){c(function(){if($("#datagrid").length>0){var b=$("#datagrid").datagrid("getPager");b.pagination({onSelectPage:function(b,c){a.bonus_data.beginNo=c*(b-1)==0?0:c*(b-1)+1,a.bonus_data.endNo=c*b,$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),d.findBonusAmount(a.bonus_data,"bonus/bonusAmountReconcile/query",function(a,b){$.messager.progress("close"),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}})}},PROGRESS_ACTION_TIMEOUT)}a.istableshow=!1,c(function(){d.findCodeTypeNames("bonus/bonusAmountReconcile/findCodeTypeNames",function(a,d){$.messager.progress("close");var e=["#dealerType"];c(function(){$("#bonusType").combobox("loadData",b.bonusType),$("#bonusType").combobox("select",b.bonusType[0].code),folUtil.setComboBoxYearDataById("year"),folUtil.setComboBoxMonthDataById("month"),folUtil.setComboBoxYesAndNoById("isDiff");for(var c=0;c<a.length;c++)folUtil.isNull(a[c])||($(e[c]).combobox("loadData",a[c]),$(e[c]).combobox("select",a[c][0].code))})},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}),a.findbonusAmountReconcile=function(){f();var b=folUtil.getComboBoxDataById("year")+"-"+folUtil.convertMonthToTwoPoint(folUtil.getComboBoxDataById("month"));a.bonus_data={dealerType:folUtil.getComboBoxDataById("dealerType"),bonusType:folUtil.getComboBoxDataById("bonusType"),changeTime:b,isDiff:folUtil.getComboBoxDataById("isDiff"),endSapCode:$("#endSapCode").textbox("getValue"),startSapCode:$("#startSapCode").textbox("getValue"),year:folUtil.getComboBoxDataById("year"),month:folUtil.convertMonthToTwoPoint(folUtil.getComboBoxDataById("month")),beginNo:0,endNo:10},a.istableshow=!0,$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),d.findbonusAmountReconcile(a.bonus_data,"bonus/bonusAmountReconcile/query",function(a,b){$.messager.progress("close"),$("#datagrid").datagrid("loadData",{total:0,rows:[]}),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})},a.bonusAmountReconcile=function(){d.getToken("services/tokens",function(b,c){return folUtil.isNull(a.bonus_data)?void $.messager.alert("提示","请先查询一次再导出"):($.messager.progress("close"),void e.open("bonus/bonusAmountReconcile/amountReconcile?bonusType="+a.bonus_data.bonusType+"&isDiff="+a.bonus_data.isDiff+"&endSapCode="+a.bonus_data.endSapCode+"&startSapCode="+a.bonus_data.startSapCode+"&changeTime="+a.bonus_data.changeTime+"&year="+a.bonus_data.year+"&month="+a.bonus_data.month+"&dealerType="+a.bonus_data.dealerType+"&token="+b.token))},function(a){console.log(a)})}}]),FolController.controller("bonusMonthDeatilCtrl",["$scope","$rootScope","$timeout","BonusService","$window",function(a,b,c,d,e){a.istableshow=!1,c(function(){var e=$("#datagrid").datagrid("getPager");e.pagination({onSelectPage:function(b,c){a.bonus_data.beginNo=c*(b-1)==0?0:c*(b-1)+1,a.bonus_data.endNo=c*b,$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),d.findBonusAmount(a.bonus_data,"bonus/bonusMonthdeatil/query",function(a,b){$.messager.progress("close"),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}}),$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),d.findCodeTypeNames("bonus/bonusMonthdeatil/findCodeTypeNames",function(a,d){$.messager.progress("close");var e=["#dealerType"];c(function(){$("#bonusType").combobox("loadData",b.bonusType),$("#bonusType").combobox("select",b.bonusType[0].code),folUtil.setComboBoxYearDataById("year"),folUtil.setComboBoxMonthDataById("month");for(var c=0;c<a.length;c++)folUtil.isNull(a[c])||($(e[c]).combobox("loadData",a[c]),$(e[c]).combobox("select",a[c][0].code))})},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}),a.findBonusMonthDeatil=function(){var b=folUtil.getComboBoxDataById("year")+"-"+folUtil.convertMonthToTwoPoint(folUtil.getComboBoxDataById("month"));a.bonus_data={dealerType:folUtil.getComboBoxDataById("dealerType"),bonusType:folUtil.getComboBoxDataById("bonusType"),sapCode:$("#sapCode").textbox("getValue"),dealerName:$("#dealerName").textbox("getValue"),changeTime:b,beginNo:0,endNo:10},a.istableshow=!0,$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),d.findBonusMonthDeatil(a.bonus_data,"bonus/bonusMonthdeatil/query",function(a,b){$.messager.progress("close"),$("#datagrid").datagrid("loadData",{total:0,rows:[]}),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})},a.monthDeatilResult=function(){d.getToken("services/tokens",function(b,c){return folUtil.isNull(a.bonus_data)?void $.messager.alert("提示","请先查询一次再导出"):($.messager.progress("close"),void e.open("bonus/bonusMonthdeatil/monthDeatilResult?dealerName="+encodeURI(encodeURI(a.bonus_data.dealerName))+"&sapCode="+a.bonus_data.sapCode+"&dealerType="+a.bonus_data.dealerType+"&bonusType="+a.bonus_data.bonusType+"&changeTime="+a.bonus_data.changeTime+"&token="+b.token))},function(a){console.log(a)})},a.findOrderDeatil=function(a){var b=$("#"+a).datagrid("getSelections");return b.length<1?void $.messager.alert("提示","请选择一条记录再操作"):b.length>1?void $.messager.alert("提示","不能选择多条记录，请选择一条记录再操作"):b[0].referType.indexOf("SAP")>-1?void $.messager.alert("提示","该条记录不能查看订单相关信息"):void $.each(b,function(a,b){var c=b.referCode,d=c.split("|");e.open(POL_SERVER_URL+"index.html#/1300_130020?orderNo="+d[0])})},a.findBillingDeatil=function(a){var b=$("#"+a).datagrid("getSelections");return b.length<1?void $.messager.alert("提示","请选择一条记录再操作"):b.length>1?void $.messager.alert("提示","不能选择多条记录，请选择一条记录再操作"):b[0].referType.indexOf("SAP")>-1?void $.messager.alert("提示","该条记录不能查看billing相关信息"):void $.each(b,function(a,b){var c=b.referCode,d=c.split("|");e.open(POL_SERVER_URL+"index.html#/1300_130040?billingNo="+d[1])})}}]),FolController.controller("bonusAmountCollectCtrl",["$scope","$rootScope","$timeout","BonusService","$window",function(a,b,c,d,e){a.istableshow=!1,c(function(){var b=$("#datagrid").datagrid("getPager");b.pagination({onSelectPage:function(b,c){a.bonus_data.beginNo=c*(b-1)==0?0:c*(b-1)+1,a.bonus_data.endNo=c*b,$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),d.findBonusAmount(a.bonus_data,"bonus/amountReconcileCollect/query",function(a,b){$.messager.progress("close"),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}}),$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),d.findCodeTypeNames("bonus/amountReconcileCollect/findCodeTypeNames",function(a,b){$.messager.progress("close");var d=["#typeName"];c(function(){folUtil.setComboBoxYearDataById("year"),folUtil.setComboBoxMonthDataById("month");for(var b=0;b<a.length;b++)folUtil.isNull(a[b])||($(d[b]).combobox("loadData",a[b]),$(d[b]).combobox("select",a[b][0].code))})},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}),a.findBonusAmountCollect=function(){var b=folUtil.getComboBoxDataById("year")+"-"+folUtil.convertMonthToTwoPoint(folUtil.getComboBoxDataById("month"));a.bonus_data={typeName:folUtil.getComboBoxDataById("typeName"),changeTime:b,year:folUtil.getComboBoxDataById("year"),month:folUtil.convertMonthToTwoPoint(folUtil.getComboBoxDataById("month")),beginNo:0,endNo:10},a.istableshow=!0,$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),d.findBonusAmountCollect(a.bonus_data,"bonus/amountReconcileCollect/query",function(a,b){$.messager.progress("close"),$("#datagrid").datagrid("loadData",{total:0,rows:[]}),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&$.messager.alert("提示","系统超时请稍后访问")})},a.amountReconcileCollect=function(){d.getToken("services/tokens",function(b,c){return folUtil.isNull(a.bonus_data)?void $.messager.alert("提示","请先查询一次再导出"):void e.open("bonus/amountReconcileCollect/amountReconcileCollect?typeName="+a.bonus_data.typeName+"&changeTime="+a.bonus_data.changeTime+"&year="+a.bonus_data.year+"&month="+a.bonus_data.month+"&token="+b.token)},function(a){console.log(a)})}}]),FolController.controller("BonusDefinitionController",["$scope","$timeout","$state","BonusDefinitionSerivce",function(a,b,c,d){b(function(){var b=$("#datagrid").datagrid("getPager");b.pagination({onSelectPage:function(b,c){a.codeVo.beginNo=c*(b-1)==0?0:c*(b-1)+1,a.codeVo.endNo=c*b,$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),d.queryBonusDefinition(a.codeVo,"bonus/type/query",function(a,b){$.messager.progress("close"),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}})}),a.addBonusDefinition=function(){c.go("addBonusDefinition")},a.queryBonusDefinition=function(){a.istableshow=!0,a.codeVo={code:a.code,codeCnDesc:a.codeCnDesc,beginNo:0,endNo:10},$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),d.queryBonusDefinition(a.codeVo,"bonus/type/query",function(b,c){$.messager.progress("close"),0===b.length?(a.istableshow=!1,$.messager.alert("提示","没有相关符合的数据")):($("#datagrid").datagrid("loadData",{total:0,rows:[]}),$("#datagrid").datagrid("loadData",b))},function(b){$.messager.progress("close"),b.state===STATE.TIMEOUT&&(a.istableshow=!1,$.messager.alert("提示","系统超时请稍后访问"))})},a.updateBonusDefinition=function(){var a=$("#datagrid").datagrid("getSelections");return a.length>1?void $.messager.alert("提示","不能选择多个奖金类型，请重新选择"):a.length<1?void $.messager.alert("提示","请选择一个奖金类型，请重新选择"):void c.go("updateBonusDefinition",{bonusType:a[0]
})}}]),FolController.controller("AddBonusDefinitionController",["$scope","$timeout","$state","BonusDefinitionSerivce",function(a,b,c,d){a.addBonusDefinition=function(){var b={code:a.code,codeCnDesc:a.codeCnDesc,remark:a.remark,typeName:"奖金类型"};a.checkData(b)&&d.addBonusDefinition(b,"bonus/type/add",function(a,b){$.messager.alert("提示","新增奖金成功"),c.go("bonusDefinition")},function(a){$.messager.alert("提示","新增奖金失败"),console.log(a)})},a.checkData=function(a){return folUtil.isNull(a.code)?($.messager.alert("提示","请填写奖金代码，再继续操作"),!1):folUtil.isNull(a.codeCnDesc)?($.messager.alert("提示","请填写奖金名称，再继续操作"),!1):!0}}]),FolController.controller("UpdateBonusDefinitionController",["$scope","$timeout","$state","$stateParams","BonusDefinitionSerivce",function(a,b,c,d,e){console.log(d.bonusType),b(function(){$("#code").textbox("setValue",d.bonusType.code),$("#codeCnDesc").textbox("setValue",d.bonusType.codeCnDesc),$("#remark").textbox("setValue",d.bonusType.remark),a.code=d.bonusType.code,a.codeCnDesc=d.bonusType.codeCnDesc,a.remark=d.bonusType.remark,a.codeId=d.bonusType.codeId}),a.updateBonusDefinition=function(){var b={codeId:a.codeId,code:a.code,codeCnDesc:a.codeCnDesc,remark:a.remark};a.checkData(b)&&e.updateBonusDefinition(b,"bonus/type/update",function(a,b){$.messager.alert("提示","更新奖金成功"),c.go("bonusDefinition")},function(a){$.messager.alert("提示","更新奖金失败"),console.log(a)})},a.checkData=function(a){return folUtil.isNull(a.code)?($.messager.alert("提示","请填写奖金代码，再继续操作"),!1):folUtil.isNull(a.codeCnDesc)?($.messager.alert("提示","请填写奖金名称，再继续操作"),!1):!0}}]),FolController.controller("BonusIssueController",["$scope","$timeout","$q","$window","BonusIssueService",function(a,b,c,d,e){a.istableshow=!1,b(function(){if($("#datagrid").length>0){var b=$("#datagrid").datagrid("getPager");b.pagination({onSelectPage:function(b,c){a.query_data.beginNo=c*(b-1)==0?0:c*(b-1)+1,a.query_data.endNo=c*b,$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),e.query(a.query_data,"bonus/bonusissue/query",function(a,b){$.messager.progress("close"),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}})}}),a.query=function(){a.istableshow=!0,a.query_data={batchNo:a.batchNo,matchState:STATE.SUCCESS_AUDIT,issueStatus:STATE.WAIT_ISSUE,type:TYPE.BONUS_ISSUE,beginNo:0,endNo:10},$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),e.query(a.query_data,"bonus/bonusissue/query",function(a,b){$.messager.progress("close"),$("#datagrid").datagrid("loadData",{total:0,rows:[]}),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})},a.bonusIssue=function(){var b=$("#datagrid").datagrid("getSelections");if(b.length<1)return void $.messager.alert("提示","请选择一个文件在发放");if(b.length>1)return void $.messager.alert("提示","不能选择多个文件在发放");var d=c.defer(),f=d.promise;$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),e.issue(b[0],"bonus/bonusissue/payBonus",function(a,b){$.messager.progress("close"),d.resolve("success")},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT?d.resolve("timeout"):d.reject("fail")}),f.then(function(b){"success"===b?$.messager.alert("提示","奖金发放成功"):(b="timeout")&&$.messager.alert("提示","奖金发放操作正在进行中，由于执行时间长请稍后查询结果"),e.query(a.query_data,"bonus/bonusissue/query",function(a,b){$("#datagrid").datagrid("loadData",{total:0,rows:[]}),$("#datagrid").datagrid("loadData",a)},function(a){a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})},function(b){$.messager.alert("提示","奖金发放失败"),e.query(a.query_data,"bonus/bonusissue/query",function(a,b){$("#datagrid").datagrid("loadData",{total:0,rows:[]}),$("#datagrid").datagrid("loadData",a)},function(a){a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})})},a.back=function(){var b=c.defer(),d=b.promise,f=$("#datagrid").datagrid("getSelections");return f.length<1?void $.messager.alert("提示","请选择一个文件在发放"):f.length>1?void $.messager.alert("提示","不能选择多个文件在发放"):(e.issue(f,"bonus/bonusissue/bonusReject",function(a,c){b.resolve("success")},function(a,c){b.reject("fail")}),void d.then(function(){$.messager.alert("提示","奖金回退成功"),e.query(a.query_data,"bonus/bonusissue/query",function(a,b){$("#datagrid").datagrid("loadData",{total:0,rows:[]}),$("#datagrid").datagrid("loadData",a)},function(a){a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})},function(){$.messager.alert("提示","奖金回退失败")}))},a.exportFile=function(){var a=$("#datagrid").datagrid("getSelections");return a.length<1?void $.messager.alert("提示","请选择一个奖金记录再进行操作"):a.length>1?void $.messager.alert("提示","不能选择多个奖金记录进行操作"):void e.getToken("services/tokens",function(b){$.messager.progress("close"),d.open("bonus/bonusissue/exportFile?issueState="+STATE.WAIT_ISSUE+"&batchNo="+a[0].batchNo+"&token="+b.token)},function(a){console.log(a)})}}]),FolController.controller("BonusIssueSuccessController",["$scope","$timeout","$q","$window","BonusIssueService",function(a,b,c,d,e){b(function(){if($("#bonusIssueGridDate").length>0){var b=$("#bonusIssueGridDate").datagrid("getPager");b.pagination({onSelectPage:function(b,c){a.bonus_Issue_Query_Condition.beginNo=c*(b-1)==0?0:c*(b-1)+1,a.bonus_Issue_Query_Condition.endNo=c*b,$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),e.query(a.bonus_Issue_Query_Condition,"bonus/bonusissue/queryBonusIssueSuc",function(a,b){$.messager.progress("close"),$("#bonusIssueGridDate").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}})}}),a.bonusIssueQuery=function(){a.istableshow=!0,a.bonus_Issue_Query_Condition={batchNo:$("#bonusIssueBatchNo").textbox("getValue"),beginDate:$("#bonusIssueBeginDate").datebox("getValue"),endDate:$("#bonusIssueEndDate").datebox("getValue"),beginNo:0,endNo:10},$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),e.bonusIssueQuery(a.bonus_Issue_Query_Condition,"bonus/bonusissue/queryBonusIssueSuc",function(a,b){$.messager.progress("close"),$("#bonusIssueGridDate").datagrid("loadData",{total:0,rows:[]}),$("#bonusIssueGridDate").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})},a.exportFile=function(){var a=$("#bonusIssueGridDate").datagrid("getSelections");return a.length<1?void $.messager.alert("提示","请选择一个奖金记录再进行操作"):a.length>1?void $.messager.alert("提示","不能选择多个奖金记录进行操作"):void e.getToken("services/tokens",function(b){$.messager.progress("close"),d.open("bonus/bonusissue/exportFile?issueState="+STATE.SUCCESS_ISSUE+"&batchNo="+a[0].batchNo+"&token="+b.token)},function(a){console.log(a)})}}]),FolController.controller("BonusIssueVersionFileAuditController",["$scope","$timeout","$q","$window","BonusIssueVersionFileAuditService","CodeService",function(a,b,c,d,e,f){a.istableshow=!1,b(function(){var c=$("#datagrid").datagrid("getPager");c.pagination({onSelectPage:function(b,c){a.query_data.beginNo=c*(b-1)==0?0:c*(b-1)+1,a.query_data.endNo=c*b,$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),e.query(a.query_data,"bonus/bonusissue/query",function(a,b){$.messager.progress("close"),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}}),$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT});var d=["渠道类型","奖金类型"];f.findCodeTypeNames(d,"code/findCodeTypeNames",function(a){$.messager.progress("close");var c=["#dealerType","#bonusType"];b(function(){for(var b=0;b<a.length;b++)folUtil.isNull(a[b])||($(c[b]).combobox("loadData",a[b]),$(c[b]).combobox("select",a[b][0].code))})},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}),a.query=function(){a.istableshow=!0,a.query_data={dealerType:folUtil.getComboBoxDataById("dealerType"),bonusType:folUtil.getComboBoxDataById("bonusType"),beginDate:$("#startTime").datebox("getValue"),endDate:$("#endTime").datebox("getValue"),batchNo:a.batchNo,matchState:STATE.REAST_AUDIT,type:TYPE.BONUS_AUDIT,beginNo:0,endNo:10},$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),e.query(a.query_data,"bonus/bonusissue/query",function(a,b){$.messager.progress("close"),$("#datagrid").datagrid("loadData",{total:0,rows:[]}),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})},a.audit=function(){var b=c.defer(),d=b.promise,f=$("#datagrid").datagrid("getSelections");return f.length<1?void $.messager.alert("提示","请选择一条记录再进行操作"):(e.audit(f,"bonus/bonusissue/bonusAudit",function(a){b.resolve("success")},function(a){b.reject("fail")}),void d.then(function(){$.messager.alert("提示","奖金发放文件审核成功"),e.query(a.query_data,"bonus/bonusissue/query",function(a,b){$.messager.progress("close"),$("#datagrid").datagrid("loadData",{total:0,rows:[]}),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})},function(){$.messager.alert("提示","奖金发放文件审核失败")}))},a.reject=function(){var b=c.defer(),d=b.promise,f=$("#datagrid").datagrid("getSelections");return f.length<1?void $.messager.alert("提示","请选择一条记录再进行操作"):(e.reject(f,"bonus/bonusissue/bonusReject",function(a,c){b.resolve("success")},function(a){b.reject("fail")}),void d.then(function(){$.messager.alert("提示","奖金发放文件驳回成功"),e.query(a.query_data,"bonus/bonusissue/query",function(a,b){$.messager.progress("close"),$("#datagrid").datagrid("loadData",{total:0,rows:[]}),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})},function(){$.messager.alert("提示","奖金发放文件驳回失败")}))},a.exportFile=function(){var a=$("#datagrid").datagrid("getSelections");return a.length<1?void $.messager.alert("提示","请选择一个奖金记录再进行操作"):a.length>1?void $.messager.alert("提示","不能选择多个奖金记录进行操作"):void e.getToken("services/tokens",function(b){$.messager.progress("close"),d.open("bonus/bonusissue/exportFile?issueState="+STATE.FAIL_ISSUE+"&batchNo="+a[0].batchNo+"&token="+b.token)},function(a){console.log(a)})}}]),FolController.controller("BonusIssueVersionUploadController",["$rootScope","$scope","$state","$timeout","$q","$window","BonusIssueVersionUploadService","CodeService",function(a,b,c,d,e,f,g,h){b.istableshow=!1,d(function(){var a=$("#datagrid").datagrid("getPager");a.pagination({onSelectPage:function(a,c){b.query_data.beginNo=c*(a-1)==0?0:c*(a-1)+1,b.query_data.endNo=c*a,$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),g.issueVersionQuery(b.query_data,"bonus/bonusissue/query",function(a,b){$.messager.progress("close"),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}}),$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT});var c=["渠道类型","奖金类型"];h.findCodeTypeNames(c,"code/findCodeTypeNames",function(a){$.messager.progress("close");var b=["#dealerType","#bonusType"];d(function(){for(var c=0;c<a.length;c++)folUtil.isNull(a[c])||($(b[c]).combobox("loadData",a[c]),$(b[c]).combobox("select",a[c][0].code))})},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}),b.issueVersionQuery=function(){b.istableshow=!0,b.query_data={dealerType:folUtil.getComboBoxDataById("dealerType"),bonusType:folUtil.getComboBoxDataById("bonusType"),beginDate:$("#startTime").datebox("getValue"),endDate:$("#endTime").datebox("getValue"),batchNo:b.batchNo,matchState:STATE.WAIT_AUDIT,type:TYPE.BONUS_UPLOAD,beginNo:0,endNo:10},$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),g.issueVersionQuery(b.query_data,"bonus/bonusissue/query",function(a,b){$.messager.progress("close"),$("#datagrid").datagrid("loadData",{total:0,rows:[]}),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})},b.issueVersionReUpload=function(){var a=$("#datagrid").datagrid("getSelections");if(a.length>1)$.messager.alert("提示","不能选择多条记录重新上传");else if(a.length<1)$.messager.alert("提示","请选择一条记录重新上传");else{var b=new Array;$.each(a[0],function(a,c){folUtil.isNull(c)||folUtil.isNull(c.publishDate)||(c.publishDate=null),b.push(c)}),c.go("uploadFilePage",{pageName:"bonusIssueVersion",data:b})}},b.cancel=function(){var a=$("#datagrid").datagrid("getSelections");if(a.length<1)$.messager.alert("提示","请选择一条记录再进行作废操作");else{var c=e.defer(),d=c.promise;g.cancel(a,"bonus/bonusissue/cancalBonusFile",function(a,b){c.resolve("success")},function(a,b){c.resvole("reject")}),d.then(function(){$.messager.alert("提示","发放文件作废成功"),$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),g.issueVersionQuery(b.query_data,"bonus/bonusissue/query",function(a,b){$.messager.progress("close"),$("#datagrid").datagrid("loadData",{total:0,rows:[]}),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})},function(){$.messager.alert("提示","发放文件作废失败")})}},b.confirmAudit=function(){var a=$("#datagrid").datagrid("getSelections");if(a.length<1)$.messager.alert("提示","请选择一条记录再进行作废操作");else{var c=e.defer(),d=c.promise;g.confirmAudit(a,"bonus/bonusissue/confirmAudit",function(a,b){c.resolve("success")},function(a){c.resvole("reject")}),d.then(function(){$.messager.alert("提示","发放文件已确认需要审核"),$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),g.issueVersionQuery(b.query_data,"bonus/bonusissue/query",function(a,b){$.messager.progress("close"),$("#datagrid").datagrid("loadData",{total:0,rows:[]}),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})},function(){$.messager.alert("提示","发放文件确认需要审核失败")})}},b.downloadTemp=function(){$.messager.progress({title:"Please waiting",msg:"downloading template...",interval:PROGRESS_ACTION_TIMEOUT}),g.getToken("services/tokens",function(a){$.messager.progress("close");var b="bonus/bonusissue/downloadTemp?token="+a.token;console.log(b),f.open(b)},function(a){$.messager.progress("close"),console.log(a)})},b.uploadBonusIssueVersion=function(){c.go("uploadFilePage",{pageName:"bonusIssueVersion"})},b.exportFile=function(){var a=$("#datagrid").datagrid("getSelections");return a.length<1?void $.messager.alert("提示","请选择一个奖金记录再进行操作"):a.length>1?void $.messager.alert("提示","不能选择多个奖金记录进行操作"):void g.getToken("services/tokens",function(b){$.messager.progress("close"),f.open("bonus/bonusissue/exportFile?issueState="+STATE.WAIT_ISSUE+"&batchNo="+a[0].batchNo+"&token="+b.token)},function(a){console.log(a)})}}]),FolController.controller("BonusReastDisposeController",["$scope","$timeout","$q","BonusReastDisposeService","CodeService",function(a,b,c,d,e){a.istableshow=!1,b(function(){var c=$("#datagrid").datagrid("getPager");c.pagination({onSelectPage:function(b,c){a.query_data.beginNo=c*(b-1)==0?0:c*(b-1)+1,a.query_data.endNo=c*b,$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),d.query(a.query_data,"bonus/bonusissue/queryBonusIssueFail",function(a,b){$.messager.progress("close"),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}}),$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT});var f=["奖金类型","销售公司类型"];e.findCodeTypeNames(f,"code/findCodeTypeNames",function(a){$.messager.progress("close");var c=["#bonusType","#serv"];b(function(){for(var b=0;b<a.length;b++)folUtil.isNull(a[b])||($(c[b]).combobox("loadData",a[b]),$(c[b]).combobox("select",a[b][0].code))})},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}),a.query=function(){a.istableshow=!0,a.query_data={bonusType:folUtil.getComboBoxDataById("bonusType"),serv:folUtil.getComboBoxDataById("serv"),batchNo:a.batchNo,sapCode:a.sapCode,beginDate:$("#startTime").datebox("getValue"),endDate:$("#endTime").datebox("getValue"),issueStatus:STATE.FAIL_ISSUE,type:TYPE.BONUS_ISSUE,beginNo:0,endNo:10},$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),d.query(a.query_data,"bonus/bonusissue/queryBonusIssueFail",function(a,b){$.messager.progress("close"),$("#datagrid").datagrid("loadData",{total:0,rows:[]}),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})},a.reastDispose=function(){var b=c.defer(),e=b.promise,f=$("#datagrid").datagrid("getSelections");return f.length<1?void $.messager.alert("提示","请选择相应的记录再操作"):(d.reastDispose(f,"bonus/bonusissue/payAgainBonus",function(a,c){b.resolve("success")},function(a){b.reject("fail")}),void e.then(function(b){$.messager.alert("提示","奖金重处理成功"),$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),d.query(a.query_data,"bonus/bonusissue/queryBonusIssueFail",function(a,b){$.messager.progress("close"),$("#datagrid").datagrid("loadData",{total:0,rows:[]}),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})},function(b){$.messager.alert("提示","奖金重处理失败"),$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),d.query(a.query_data,"bonus/bonusissue/queryBonusIssueFail",function(a,b){$.messager.progress("close"),$("#datagrid").datagrid("loadData",{total:0,rows:[]}),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}))},a.back=function(){var b=c.defer(),e=b.promise,f=$("#datagrid").datagrid("getSelections");return f.length<1?void $.messager.alert("提示","请选择一条记录再进行操作"):(d.reject(f,"bonus/bonusissue/bonusReject",function(a,c){b.resolve("success")},function(a){b.reject("fail")}),void e.then(function(){$.messager.alert("提示","奖金发放文件驳回成功"),d.query(a.query_data,"bonus/bonusissue/queryBonusIssueFail",function(a,b){$.messager.progress("close"),$("#datagrid").datagrid("loadData",{total:0,rows:[]}),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})},function(){$.messager.alert("提示","奖金发放文件驳回失败")}))},a.exportFile=function(){var a=$("#datagrid").datagrid("getSelections");return a.length<1?void $.messager.alert("提示","请选择一个奖金记录再进行操作"):a.length>1?void $.messager.alert("提示","不能选择多个奖金记录进行操作"):void d.getToken("services/tokens",function(b){$.messager.progress("close"),$window.open("bonus/bonusissue/exportFile?issueState="+STATE.FAIL_ISSUE+"&batchNo="+a[0].batchNo+"&token="+b.token)},function(a){console.log(a)})}}]),FolController.controller("authorityCtrl",["$scope","$rootScope","$http","$state","$timeout","AuthorityService",function(a,b,c,d,e,f){a.istableshow=!1,f.systemRoRiMainss("authority/authorityamount/code/type/1071",function(a){e(function(){console.log(a),$("#roleType").combobox("loadData",a),$("#roleType").combobox("select",a[0].code)})},function(a){console.log("error:"+a)});var g=function(b,c){a.istableshow=!0;var d={roleType:folUtil.getComboBoxDataById("roleType"),beginNo:(b-1)*c,endNo:b*c+1};$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),f.systemRoRiMain(d,"authority/authorityamount/query",function(a){$.messager.progress("close"),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),console.log(a)})};a.systemRoRiMain=function(){g(1,10),$("#datagrid").datagrid("getPager").pagination({onSelectPage:function(a,b){g(a,b)}})},a.delsystem=function(){var a=$("#datagrid").datagrid("getSelected");a?confirm("确定删除吗?")&&f.delsystem(a,"authority/authorityamount/delAuthority",function(a){alert("删除成功"),$("#datagrid").datagrid("loadData",{total:0,rows:[]}),g(1,10)},function(a){alert("删除失败"),console.log(a)}):alert("请选择一条记录")},a.systemRoRiMains=function(){var a=$("#datagrid").datagrid("getSelected");a?(f.setRoleData(a),d.go("systemRoRiMains")):alert("请选择一条记录")},a.updateRoleAuthority=function(){var a=$("#datagrid").datagrid("getSelected");a?(f.setRoleData(a),d.go("updateRoleAuthority")):alert("请选择一条记录")},a.systemRoRiMainsAd=function(){d.go("systemRoRiMainsAdd")}}]),FolController.controller("authorityUpdateCtrl",["$scope","$state","$timeout","AuthorityService",function(a,b,c,d){c(function(){$("#roleId").textbox("setValue",d.getRoleData().roleId),$("#roleName").textbox("setValue",d.getRoleData().roleName),$("#roleDesc").textbox("setValue",d.getRoleData().roleDesc)}),d.systemRoRiMainss("authority/authorityamount/code/type/1071",function(a){c(function(){$("#roleType").combobox("loadData",a),$("#roleType").combobox("select",d.getRoleData().roleType)})},function(a){console.log("error:"+a)}),$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),$("#roleType").combobox({onChange:function(a,b){var c=$("#roleType").combobox("getValue");""!=c?d.findMenu("","authority/authorityamount/Menuquery/type/"+c+"/role/"+d.getRoleData().roleId,function(a){$.messager.progress("close"),$("#roledatagrid").datagrid({data:a,onLoadSuccess:function(a){a&&$.each(a.rows,function(a,b){b.checked&&$("#roledatagrid").datagrid("checkRow",a)})}})},function(a){console.log(a)}):$("#roledatagrid").datagrid("loadData",[])}}),a.systemPoRoMainA=function(){if(null==$("#roleName").textbox("getValue")||""==$("#roleName").textbox("getValue")||$("#roleName").textbox("getValue")<0)return void alert("请填写角色名称");if(null==$("#roleType").combobox("getValue")||""==$("#roleType").combobox("getValue")||$("#roleType").combobox("getValue")<0)return void alert("请选择角色类型");var a={roleId:$("#roleId").textbox("getValue"),roleName:$("#roleName").textbox("getValue"),roleType:folUtil.getComboBoxDataById("roleType"),roleDesc:$("#roleDesc").textbox("getValue")},c="",e=$("#roledatagrid").datagrid("getChecked");e.length>0&&($.each(e,function(a,b){c=c+b.menuId+","}),c+=" ",c=c.replace(", ","")),a.menuId=c,d.checkdata(a,"authority/authorityamount/getSign",function(c,e){d.systemPoRoMainA(a,"authority/authorityamount/update",function(a){alert("修改成功"),b.go("systemRoRiMain")},function(a){alert("修改失败"),console.log(a)})},function(a){a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}}]),FolController.controller("roleAuthorityUpdateCtrl",["$scope","$state","$timeout","AuthorityService",function(a,b,c,d){c(function(){$("#roleId").textbox("setValue",d.getRoleData().roleId),$("#roleName").textbox("setValue",d.getRoleData().roleName),$("#roleDesc").textbox("setValue",d.getRoleData().roleDesc)}),d.systemRoRiMainss("authority/authorityamount/code/type/1071",function(a){c(function(){$("#roleType").combobox("loadData",a),$("#roleType").combobox("select",d.getRoleData().roleType)})},function(a){console.log("error:"+a)}),$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),$("#roleType").combobox({onChange:function(a,b){var c=$("#roleType").combobox("getValue");""!=c?d.findMenu("","authority/authorityamount/methodQuery/role/"+d.getRoleData().roleId,function(a){$.messager.progress("close"),$("#roledatagrid").datagrid({data:a,onLoadSuccess:function(a){a&&$.each(a.rows,function(a,b){b.checked&&$("#roledatagrid").datagrid("checkRow",a)})}})},function(a){console.log(a)}):$("#roledatagrid").datagrid("loadData",[])}}),a.systemPoRoMainA=function(){if(null==$("#roleName").textbox("getValue")||""==$("#roleName").textbox("getValue")||$("#roleName").textbox("getValue")<0)return void alert("请填写角色名称");if(null==$("#roleType").combobox("getValue")||""==$("#roleType").combobox("getValue")||$("#roleType").combobox("getValue")<0)return void alert("请选择角色类型");var a={roleId:$("#roleId").textbox("getValue"),roleName:$("#roleName").textbox("getValue"),roleType:folUtil.getComboBoxDataById("roleType"),roleDesc:$("#roleDesc").textbox("getValue")},c="",e=$("#roledatagrid").datagrid("getChecked");e.length>0&&($.each(e,function(a,b){c=c+b.methodId+","}),c+=" ",c=c.replace(", ","")),a.methodId=c,d.systemPoRoMainA(a,"authority/authorityamount/updateAuthorityMethod",function(a){alert("修改成功"),b.go("systemRoRiMain")},function(a){alert("修改失败"),console.log(a)})}}]),FolController.controller("authorityAddCtrl",["$scope","$http","$state","$timeout","AuthorityService",function(a,b,c,d,e){e.systemRoRiMainss("authority/authorityamount/code/type/1071",function(a){d(function(){$("#roleType").combobox("loadData",a),$("#roleType").combobox("select",a[0].code)})},function(a){console.log("error:"+a)}),$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),$("#roleType").combobox({onChange:function(a,b){var c=$("#roleType").combobox("getValue");""!=c?e.findMenu("","authority/authorityamount/Menuquery/type/"+c,function(a){$.messager.progress("close"),$("#roledatagrid").datagrid("loadData",a)},function(a){console.log(a)}):$("#roledatagrid").datagrid("loadData",[])}}),a.systemPoRoMainAdd=function(){return null==$("#roleName").textbox("getValue")||""==$("#roleName").textbox("getValue")||$("#roleName").textbox("getValue")<0?void $.messager.alert("提示","请填写角色名称"):null==$("#roleType").combobox("getValue")||""==$("#roleType").combobox("getValue")||$("#roleType").combobox("getValue")<0?void $.messager.alert("提示","请选择角色类型"):void e.get("authority/authorityamount/name/"+$("#roleName").textbox("getValue"),function(a){0==a[0]?f():$.messager.alert("提示","角色已存在,不能新增")},function(a){$.messager.alert("提示","新增失败"),console.log(a)})};var f=function(){var a={roleName:$("#roleName").textbox("getValue"),roleType:folUtil.getComboBoxDataById("roleType"),roleDesc:$("#roleDesc").textbox("getValue")},b="",d=$("#roledatagrid").datagrid("getChecked");d.length>0&&($.each(d,function(a,c){b=b+c.menuId+","}),b+=" ",b=b.replace(", ","")),a.menuId=b,e.checkdata(a,"authority/authorityamount/getSign",function(b,d){e.systemPoRoMainA(a,"authority/authorityamount/roleAdd",function(a){$.messager.alert("提示","新增成功"),c.go("systemRoRiMain")},function(a){$.messager.alert("提示","新增失败"),console.log(a)})},function(a){a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}}]),FolController.controller("PersonRoleCtrl",["$scope","$state","$timeout","PersonRoleService",function(a,b,c,d){a.istableshow=!1,d.get("authority/authorityamount/code/type/1001",function(a){c(function(){$("#userStatus").combobox("loadData",a),$("#userStatus").combobox("select",a[0].code)})},function(a){console.log("error:"+a)}),d.get("system/systemamount/type/1|2",function(a){c(function(){a.unshift({positionId:"",positionName:"请选择"}),$("#positionId").combobox("loadData",a),$("#positionId").combobox("select",a[0].positionId)})},function(a){console.log("error:"+a)});var e=function(b,c){a.istableshow=!0;var e={userName:$("#userName").textbox("getValue"),userAccount:$("#userAccount").textbox("getValue"),userStatus:folUtil.getComboBoxDataById("userStatus"),positionId:folUtil.getComboBoxDataById("positionId"),beginNo:(b-1)*c,endNo:b*c+1};$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),d.post(e,"common/users/query",function(a){$.messager.progress("close"),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),console.log(a)})};a.findPersonRole=function(){e(1,10),$("#datagrid").datagrid("getPager").pagination({onSelectPage:function(a,b){e(a,b)}})},a.updataPersonRoles=function(){var a=$("#datagrid").datagrid("getSelected");a?(d.setPersonData(a),b.go("updataPersonRole")):alert("请选择一条记录")},a.userAdd=function(){b.go("userAdd")},a.delUser=function(){var a=$("#datagrid").datagrid("getSelected");a?confirm("确定删除吗?")&&d.del(a,"common/users/delete",function(a){alert("删除成功"),e(1,10)},function(a){alert("删除失败"),console.log(a)}):alert("请选择一条记录")}}]),FolController.controller("updataPersonRoleCtrl",["$scope","$state","$stateParams","$timeout","PersonRoleService",function(a,b,c,d,e){d(function(){$("#birthday").datebox("setValue",e.getPersonData().birthday),$("#userAccount").textbox("setValue",e.getPersonData().userAccount),$("#userName").textbox("setValue",e.getPersonData().userName),$("#handPhone").textbox("setValue",e.getPersonData().handPhone),$("#zipCode").textbox("setValue",e.getPersonData().zipCode),$("#addr").textbox("setValue",e.getPersonData().addr),$("#email").textbox("setValue",e.getPersonData().email)}),$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),$("#userType").combobox({onChange:function(a,b){var c=$("#userType").combobox("getValue");""!=c?e.get("system/systemamount/type/"+c+"/user/"+e.getPersonData().userAccount,function(a){d(function(){$.messager.progress("close"),$("#grid_positions").datagrid({data:a[0],onLoadSuccess:function(a){a&&$.each(a.rows,function(a,b){b.checked&&$("#grid_positions").datagrid("checkRow",a)})}})})},function(a){console.log(a)}):$("#grid_positions").datagrid("loadData",[])}}),e.get("authority/authorityamount/code/type/1001",function(a){d(function(){$("#userStatus").combobox("loadData",a),$("#userStatus").combobox("select",e.getPersonData().userStatus)})},function(a){console.log("error:"+a)}),e.get("authority/authorityamount/code/type/1012",function(a){d(function(){$("#gender").combobox("loadData",a),$("#gender").combobox("select",e.getPersonData().gender)})},function(a){console.log("error:"+a)}),e.get("authority/authorityamount/code/type/1071",function(a){d(function(){$("#userType").combobox("loadData",a),$("#userType").combobox("select",e.getPersonData().userType)})},function(a){console.log("error:"+a)}),a.userUpdate=function(){if(null==$("#userAccount").textbox("getValue")||""==$("#userAccount").textbox("getValue")||$("#userAccount").textbox("getValue")<0)return void alert("请填写帐号名");if(null==$("#userType").combobox("getValue")||""==$("#userType").combobox("getValue")||0==$("#userType").combobox("getValue"))return void alert("请选择用户类型");if(null==$("#userName").textbox("getValue")||""==$("#userName").textbox("getValue")||$("#userName").textbox("getValue")<0)return void alert("请填写姓名");if(null==$("#gender").combobox("getValue")||""==$("#gender").combobox("getValue")||0==$("#gender").combobox("getValue"))return void alert("请选择性别");if(null==$("#userStatus").combobox("getValue")||""==$("#userStatus").combobox("getValue")||0==$("#userStatus").combobox("getValue"))return void alert("请选择启用状态");var a=/^1\d{10}$/;if(!folUtil.isNull($("#handPhone").textbox("getValue"))&&!a.test($("#handPhone").textbox("getValue")))return void alert("请正确填写手机号！");var a=/[a-zA-Z0-9]{1,10}@[a-zA-Z0-9]{1,5}\.[a-zA-Z0-9]{1,5}/;if(!folUtil.isNull($("#email").textbox("getValue"))&&!a.test($("#email").textbox("getValue")))return void alert("请正确填写邮箱！");
var c={userAccount:$("#userAccount").textbox("getValue"),userType:folUtil.getComboBoxDataById("userType"),userName:$("#userName").textbox("getValue"),gender:folUtil.getComboBoxDataById("gender"),handPhone:$("#handPhone").textbox("getValue"),birthday:$("#birthday").textbox("getValue"),zipCode:$("#zipCode").textbox("getValue"),addr:$("#addr").textbox("getValue"),email:$("#email").textbox("getValue"),userStatus:folUtil.getComboBoxDataById("userStatus")},d="",f=$("#grid_positions").datagrid("getChecked");f.length>0&&($.each(f,function(a,b){d=d+b.positionId+","}),d+=" ",d=d.replace(", ","")),c.positions=d,e.checkdata(c,"common/users/getSign",function(a,d){e.put(c,"common/users/update",function(a){alert("修改成功"),b.go("personRole")},function(a){a.state===STATE.TIMEOUT?(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问")):alert("修改失败"),console.log(a)})},function(a){a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}}]),FolController.controller("addUserCtrl",["$scope","$state","$stateParams","$timeout","PersonRoleService","AuthorityService",function(a,b,c,d,e,f){e.get("authority/authorityamount/code/type/1001",function(a){d(function(){$("#userStatus").combobox("loadData",a),$("#userStatus").combobox("select",a[1].code)})},function(a){console.log("error:"+a)}),$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),e.get("authority/authorityamount/code/type/1012",function(a){d(function(){$.messager.progress("close"),$("#gender").combobox("loadData",a),$("#gender").combobox("select",a[0].code)})},function(a){console.log("error:"+a)}),e.get("authority/authorityamount/code/type/1071",function(a){d(function(){$("#userType").combobox("loadData",a),$("#userType").combobox("select",a[1].code)})},function(a){console.log("error:"+a)}),$("#userType").combobox({onChange:function(a,b){var c=$("#userType").combobox("getValue");""!=c?e.get("system/systemamount/type/"+c,function(a){$("#grid_positions").datagrid("loadData",a)},function(a){console.log(a)}):$("#grid_positions").datagrid("loadData",[])}}),a.checkUser=function(){},a.userAdd=function(){if(null==$("#userAccount").textbox("getValue")||""==$("#userAccount").textbox("getValue")||$("#userAccount").textbox("getValue")<0)return void alert("请填写帐号名");if(null==$("#userType").combobox("getValue")||""==$("#userType").combobox("getValue")||0==$("#userType").combobox("getValue"))return void alert("请选择用户类型");if(null==$("#userName").textbox("getValue")||""==$("#userName").textbox("getValue")||$("#userName").textbox("getValue")<0)return void alert("请填写姓名");if(null==$("#gender").combobox("getValue")||""==$("#gender").combobox("getValue")||0==$("#gender").combobox("getValue")||-1==$("#gender").combobox("getValue"))return void alert("请选择性别");if(null==$("#userStatus").combobox("getValue")||""==$("#userStatus").combobox("getValue")||0==$("#userStatus").combobox("getValue"))return void alert("请选择启用状态");var a=/^1\d{10}$/;if(!folUtil.isNull($("#handPhone").textbox("getValue"))&&!a.test($("#handPhone").textbox("getValue")))return void alert("请正确填写手机号！");var a=/[a-zA-Z0-9]{1,10}@[a-zA-Z0-9]{1,5}\.[a-zA-Z0-9]{1,5}/;return folUtil.isNull($("#email").textbox("getValue"))||a.test($("#email").textbox("getValue"))?void e.get("common/users/account/"+$("#userAccount").textbox("getValue"),function(a){0==a[0]?g():alert("帐号已存在,不能新增")},function(a){alert("新增失败"),console.log(a)}):void alert("请正确填写邮箱！")};var g=function(){var a={userAccount:$("#userAccount").textbox("getValue"),userType:folUtil.getComboBoxDataById("userType"),userName:$("#userName").textbox("getValue"),gender:folUtil.getComboBoxDataById("gender"),handPhone:$("#handPhone").textbox("getValue"),birthday:$("#birthday").textbox("getValue"),zipCode:$("#zipCode").textbox("getValue"),addr:$("#addr").textbox("getValue"),email:$("#email").textbox("getValue"),userStatus:folUtil.getComboBoxDataById("userStatus")},c="",d=$("#grid_positions").datagrid("getChecked");d.length>0&&($.each(d,function(a,b){c=c+b.positionId+","}),c+=" ",c=c.replace(", ","")),a.positions=c,f.checkdata(a,"common/users/getSign",function(c,d){e.post(a,"common/users/add",function(a){alert("新增成功"),b.go("personRole")},function(a){alert("新增失败"),console.log(a)})},function(a){a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}}]),FolController.controller("systemCtrl",["$scope","$state","SystemService",function(a,b,c){a.istableshow=!1;var d=function(b,d){a.istableshow=!0;var e={positionName:$("#positionName").textbox("getValue"),dpPositionCode:$("#dpPositionCode").textbox("getValue"),beginNo:(b-1)*d,endNo:b*d+1};$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),c.systemPoRoMain(e,"system/systemamount/query",function(a){$.messager.progress("close"),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),console.log(a)})};a.systemPoRoMain=function(){d(1,10),$("#datagrid").datagrid("getPager").pagination({onSelectPage:function(a,b){d(a,b)}})},a.systemPoRoMains=function(){var a=$("#datagrid").datagrid("getSelected");a?(c.setPositionData(a),b.go("systemPoRoMains")):alert("请选择一条记录")},a.systemPoRoAdd=function(){b.go("systemPoRoMainsAdd")},a.systemPoRoDel=function(){var a=$("#datagrid").datagrid("getSelected");a?confirm("确定删除吗?")&&c.del(a,"system/systemamount/del",function(a){alert("删除成功"),d(1,10)},function(a){alert("删除失败"),console.log(a)}):alert("请选择一条记录")}}]),FolController.controller("systemUpdateCtrl",["$scope","$state","$timeout","$stateParams","SystemService",function(a,b,c,d,e){c(function(){$("#positionId").textbox("setValue",e.getPositionData().positionId),$("#positionName").textbox("setValue",e.getPositionData().positionName),$("#positionDesc").textbox("setValue",e.getPositionData().positionDesc),$("#dpPositionCode").textbox("setValue",e.getPositionData().dpPositionCode)}),e.get("authority/authorityamount/code/type/1071",function(a){c(function(){$("#positionType").combobox("loadData",a),$("#positionType").combobox("select",e.getPositionData().positionType)})},function(a){console.log("error:"+a)}),$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),$("#positionType").combobox({onChange:function(a,b){var c=$("#positionType").combobox("getValue");""!=c?e.get("authority/authorityamount/type/"+c+"/position/"+e.getPositionData().positionId,function(a){$.messager.progress("close"),$("#roledatagrid").datagrid("loadData",a),$("#roledatagrid").datagrid({data:a,onLoadSuccess:function(a){a&&$.each(a.rows,function(a,b){b.checked&&$("#roledatagrid").datagrid("checkRow",a)})}})},function(a){console.log(a)}):$("#roledatagrid").datagrid("loadData",[])}}),a.systemPoRoMainA=function(){if(null==$("#positionName").textbox("getValue")||""==$("#positionName").textbox("getValue")||$("#positionName").textbox("getValue")<0)return void alert("请填写岗位名称");if(null==$("#positionType").combobox("getValue")||""==$("#positionType").combobox("getValue")||$("#positionType").combobox("getValue")<0)return void alert("请选择岗位类型");var a={positionName:$("#positionName").textbox("getValue"),positionId:$("#positionId").textbox("getValue"),positionType:folUtil.getComboBoxDataById("positionType"),positionDesc:$("#positionDesc").textbox("getValue"),dpPositionCode:$("#dpPositionCode").textbox("getValue")},c="",d=$("#roledatagrid").datagrid("getChecked");d.length>0&&($.each(d,function(a,b){c=c+b.roleId+","}),c+=" ",c=c.replace(", ","")),a.roles=c,e.checkdata(a,"system/systemamount/getSign",function(a,c){e.put(a,"system/systemamount/update",function(a){alert("修改成功"),b.go("systemPoRoMain")},function(a){alert("修改失败"),console.log(a)})},function(a){a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}}]),FolController.controller("systemAddCtrl",["$scope","$state","$stateParams","$timeout","SystemService","AuthorityService",function(a,b,c,d,e,f){e.get("authority/authorityamount/code/type/1071",function(a){d(function(){$("#positionType").combobox("loadData",a),$("#positionType").combobox("select",a[0].code)})},function(a){console.log("error:"+a)}),$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),$("#positionType").combobox({onChange:function(a,b){var c=$("#positionType").combobox("getValue");""!=c?e.get("authority/authorityamount/type/"+c,function(a){$.messager.progress("close"),$("#roledatagrid").datagrid("loadData",a)},function(a){console.log(a)}):$("#roledatagrid").datagrid("loadData",[])}}),a.systemPoRoMainAdd=function(){return null==$("#positionName").textbox("getValue")||""==$("#positionName").textbox("getValue")||$("#positionName").textbox("getValue")<0?void alert("请填写岗位名称"):null==$("#positionType").combobox("getValue")||""==$("#positionType").combobox("getValue")||$("#positionType").combobox("getValue")<0?void alert("请选择岗位类型"):void e.get("system/systemamount/name/"+$("#positionName").textbox("getValue"),function(a){0==a[0]?g():alert("岗位已存在,不能新增")},function(a){alert("新增失败"),console.log(a)})};var g=function(){var a={positionName:$("#positionName").textbox("getValue"),positionType:folUtil.getComboBoxDataById("positionType"),positionDesc:$("#positionDesc").textbox("getValue"),dpPositionCode:$("#dpPositionCode").textbox("getValue")},c="",d=$("#roledatagrid").datagrid("getChecked");d.length>0&&($.each(d,function(a,b){c=c+b.roleId+","}),c+=" ",c=c.replace(", ","")),a.roles=c,f.checkdata(a,"system/systemamount/getSign",function(c,d){e.post(a,"system/systemamount/add",function(a){alert("新增成功"),b.go("systemPoRoMain")},function(a){alert("新增失败"),console.log(a)})},function(a){a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}}]),FolController.controller("UserController",["$scope","UserService",function(a,b){a.doLogout=function(){b.logout("common/logout",function(a){$.messager.alert("退出已成功")},function(a){console.log(a)})}}]),FolController.controller("authorityMaintainCtrl",["$scope","$rootScope","$http","$state","$timeout","RoleAuthorityService",function(a,b,c,d,e,f){a.istableshow=!1,e(function(){var b=$("#datagrid").datagrid("getPager");b.pagination({onSelectPage:function(b,c){a.authority_data.beginNo=c*(b-1)==0?0:c*(b-1)+1,a.authority_data.endNo=c*b,$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),f.systemRoRiMain(a.authority_data,"authority/authormethod/query",function(a){$.messager.progress("close"),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}})}),a.systemRoRiMain=function(){a.istableshow=!0,a.authority_data={clazz:$("#clazz").textbox("getValue"),beginNo:0,endNo:10},f.systemRoRiMain(a.authority_data,"authority/authormethod/query",function(a){$.messager.progress("close"),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})},a.delsystem=function(){var b=$("#datagrid").datagrid("getSelected");b?confirm("确定删除吗?")&&f.delsystem(b,"authority/authormethod/delete",function(b){alert("删除成功"),a.authority_data.beginNo=0,a.authority_data.endNo=10,f.systemRoRiMain(a.authority_data,"authority/authormethod/query",function(a){$("#datagrid").datagrid("loadData",{total:0,rows:[]}),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})},function(a){alert("删除失败"),console.log(a)}):alert("请选择一条记录")},a.systemRoRiMains=function(){var a=$("#datagrid").datagrid("getSelected");a?(f.setRoleData(a),d.go("roleAuthorityMains")):alert("请选择一条记录")},a.systemRoRiMainsAd=function(){d.go("roleAuthorityMainsAdd")}}]),FolController.controller("roleAuthorityMaintainUpdateCtrl",["$scope","$state","$timeout","RoleAuthorityService",function(a,b,c,d){c(function(){$("#clazz").textbox("setValue",d.getRoleData().clazz),$("#methodId").textbox("setValue",d.getRoleData().methodId),$("#method").textbox("setValue",d.getRoleData().method),$("#url").textbox("setValue",d.getRoleData().url)}),a.systemPoRoMainA=function(){if(null==$("#clazz").textbox("getValue")||""==$("#clazz").textbox("getValue")||$("#clazz").textbox("getValue")<0)return void alert("请填写角色权限类名");if(null==$("#method").textbox("getValue")||""==$("#method").textbox("getValue")||$("#method").textbox("getValue")<0)return void alert("请填写角色权限方法名");if(null==$("#url").textbox("getValue")||""==$("#url").textbox("getValue")||$("#url").textbox("getValue")<0)return void alert("请填写角色权限URI");var a={methodId:$("#methodId").textbox("getValue"),clazz:$("#clazz").textbox("getValue"),method:$("#method").textbox("getValue"),url:$("#url").textbox("getValue")};d.systemPoRoMainA(a,"authority/authormethod/update",function(a){alert("修改成功"),b.go("roleAuthorityMain")},function(a){response_info.state===STATE.TIMEOUT?(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问")):alert("修改失败"),console.log(a)})},a.cancel=function(){b.go("roleAuthorityMain")}}]),FolController.controller("roleAuthorityMaintainAddCtrl",["$scope","$http","$state","$timeout","RoleAuthorityService",function(a,b,c,d,e){a.systemPoRoMainAdd=function(){if(null==$("#clazz").textbox("getValue")||""==$("#clazz").textbox("getValue")||$("#clazz").textbox("getValue")<0)return void alert("请填写角色权限类名");if(null==$("#method").textbox("getValue")||""==$("#method").textbox("getValue")||$("#method").textbox("getValue")<0)return void alert("请填写角色权限方法名");if(null==$("#url").textbox("getValue")||""==$("#url").textbox("getValue")||$("#url").textbox("getValue")<0)return void alert("请填写角色权限URI");var a={clazz:$("#clazz").textbox("getValue"),method:$("#method").textbox("getValue"),url:$("#url").textbox("getValue")};e.systemPoRoMainA(a,"authority/authormethod/add",function(a){$.messager.alert("提示","新增成功"),c.go("roleAuthorityMain")},function(a){$.messager.alert("提示","新增失败"),console.log(a)})},a.cancel=function(){c.go("roleAuthorityMain")}}]),FolController.controller("reserveAmountCtrl",["$scope","$rootScope","ReserveService","$state","$timeout","$window",function(a,b,c,d,e,f){a.istableshow=!1,e(function(){var b=$("#datagrid").datagrid("getPager");b.pagination({onSelectPage:function(b,d){a.reserve_amount_data.beginNo=d*(b-1)==0?0:d*(b-1)+1,a.reserve_amount_data.endNo=d*b,$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),c.findReserveAmount(a.reserve_amount_data,"reserve/reserveamount/query",function(a,b){$.messager.progress("close"),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}}),$("#ReserveDeatilWindow").panel({onBeforeOpen:function(){$("#changeAmountDataGrid").attr("class","row-fluid ng-hide"),$("#freezeAmountDataGrid").attr("class","row-fluid ng-hide")}})}),a.findReserveAmount=function(){a.reserve_amount_data={dealerType:folUtil.getComboBoxDataById("dealerType"),reserveType:folUtil.getComboBoxDataById("reserveType"),sapCode:$("#sapCode").val(),beginNo:0,endNo:10},a.istableshow=!0,$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),c.findReserveAmount(a.reserve_amount_data,"reserve/reserveamount/query",function(a,b){$.messager.progress("close"),$("#datagrid").datagrid("loadData",{total:0,rows:[]}),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})},$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),c.findCodeTypeNames("reserve/reserveamount/findCodeTypeNames",function(a,c){$.messager.progress("close");var d=["#dealerType"];e(function(){$("#reserveType").combobox("loadData",b.reserveType),$("#reserveType").combobox("select",b.reserveType[0].code);for(var c=0;c<a.length;c++)folUtil.isNull(a)||($(d[c]).combobox("loadData",a[c]),$(d[c]).combobox("select",a[c][0].code))})},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))}),a.exportReserveQueryResult=function(){c.getToken("services/tokens",function(b){return folUtil.isNull(a.reserve_amount_data)?void $.messager.alert("提示","请先查询一次再导出"):($.messager.progress("close"),void f.open("reserve/reserveamount/exportReserveQueryResult?dealerType="+a.reserve_amount_data.dealerType+"&reserveType="+a.reserve_amount_data.reserveType+"&sapCode="+a.reserve_amount_data.sapCode+"&token="+b.token))},function(a){$.messager.progress("close"),console.log(a)})},a.findReconciliationDeatil=function(){var b=$("#datagrid").datagrid("getSelections");return b.length<=0?void $.messager.alert("提示","请选择某条记录再操作"):b.length>1?void $.messager.alert("提示","只能选择一条记录进行操作"):(a.dealer=b[0],$("#deatilSapCode").textbox({value:a.dealer.sapCode}),void $("#ReserveDeatilWindow").window("open"))}}]),FolController.controller("reserveDeatilChangeCtrl",["$scope","$rootScope","$timeout","ReserveService","$q","$window",function(a,b,c,d,e,f){a.istableshow=!1,c(function(){var f=$("#changeAmountDataGrid").datagrid("getPager"),g=e.defer();g.promise;f.pagination({onSelectPage:function(b,c){a.reserve_data.beginNo=c*(b-1)==0?0:c*(b-1)+1,a.reserve_data.endNo=c*b,$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),d.findChangeReserveAmount(a.reserve_data,"reserve/reservedeatilchange/changedeatilreserve/query",function(a,b){$.messager.progress("close"),$("#changeAmountDataGrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT?(console.log(a),$.messager.alert("提示","系统超时或请检查账号状态,如没问题请刷新页面重新操作")):$.messager.alert("提示",a.message)})}});var h=$("#freezeAmountDataGrid").datagrid("getPager");h.pagination({onSelectPage:function(b,c){a.reserve_data.beginNo=c*(b-1)==0?0:c*(b-1)+1,a.reserve_data.endNo=c*b,$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),d.findFreezeReserveAmount(a.reserve_data,"reserve/reservedeatilchange/freezedeatilreserve/query",function(a,b){$.messager.progress("close"),$("#freezeAmountDataGrid").datagrid("loadData",a)},function(a){a.state===STATE.TIMEOUT?($.messager.progress("close"),$.messager.alert("提示","系统超时或请检查账号状态,如没问题请刷新页面重新操作")):$.messager.alert("提示",a.message)})}}),$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),d.findCodeTypeNames("reserve/reservedeatilchange/findCodeTypeNames",function(a,d){$.messager.progress("close");var e=["#dealerType","#businessCode"];c(function(){$("#reserveType").combobox("loadData",b.reserveType),$("#reserveType").combobox("select",b.reserveType[0].code);for(var c=0;c<a.length;c++)folUtil.isNull(a[c])||($(e[c]).combobox("loadData",a[c]),$(e[c]).combobox("select",a[c][0].code))})},function(a){$.messager.progress("close"),folUtil.isNull(a)&&$.messager.alert("提示","系统超时或请检查账号状态,如没问题请刷新页面重新操作")})}),a.findReserveDeatilChange=function(){var b=e.defer(),c=b.promise,f=!1,g=!1;return $("#startTime").datebox("getText")>$("#endTime").datebox("getText")?void $.messager.alert("提示","开始时间不能大于结束时间"):(a.reserve_data={dealerType:folUtil.getComboBoxDataById("dealerType"),reserveType:folUtil.getComboBoxDataById("reserveType"),sapCode:$("#sapCode").val(),businessCode:folUtil.getComboBoxDataById("businessCode"),startTime:$("#startTime").datebox("getValue"),endTime:$("#endTime").datebox("getValue"),beginNo:0,endNo:10},a.istableshow=!0,$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),d.findChangeReserveAmount(a.reserve_data,"reserve/reservedeatilchange/changedeatilreserve/query",function(a,c){$("#changeAmountDataGrid").datagrid("loadData",{total:0,rows:[]}),$("#changeAmountDataGrid").datagrid("loadData",a),f=!0,g&&f&&b.resolve("success")},function(a){a.state===STATE.TIMEOUT?(console.log(a),b.reject("timeout")):b.reject("error")}),d.findFreezeReserveAmount(a.reserve_data,"reserve/reservedeatilchange/freezedeatilreserve/query",function(a,c){$("#freezeAmountDataGrid").datagrid("loadData",{total:0,rows:[]}),$("#freezeAmountDataGrid").datagrid("loadData",a),g=!0,g&&f&&b.resolve("success")},function(a){a.state===STATE.TIMEOUT?b.reject("timeout"):b.reject("error")}),void c.then(function(a){console.log(a),"success"===a&&$.messager.progress("close")},function(a){console.log(a),$.messager.progress("close"),"timeout"==a?$.messager.alert("提示","系统超时或请检查账号状态,如没问题请刷新页面重新操作"):$.messager.alert("提示","系统出错")}))},a.deatilChangeResult=function(){d.getToken("services/tokens",function(b){return folUtil.isNull(a.reserve_data)?void $.messager.alert("提示","请先查询一次再导出"):(f.open("reserve/reservedeatilchange/ChangeReserveAmount?dealerType="+a.reserve_data.dealerType+"&reserveType="+a.reserve_data.reserveType+"&businessCode="+a.reserve_data.businessCode+"&sapCode="+a.reserve_data.sapCode+"&startTime="+a.reserve_data.startTime+"&endTime="+a.reserve_data.endTime+"&token="+b.token),void f.open("reserve/reservedeatilchange/FreezeReserveAmount?dealerType="+a.reserve_data.dealerType+"&reserveType="+a.reserve_data.reserveType+"&businessCode="+a.reserve_data.businessCode+"&sapCode="+a.reserve_data.sapCode+"&startTime="+a.reserve_data.startTime+"&endTime="+a.reserve_data.endTime+"&token="+b.token))},function(a){console.log(a)})},a.findOrderDeatil=function(a){var b=$("#"+a).datagrid("getSelections");return b.length<1?void $.messager.alert("提示","请选择一条记录再操作"):void $.each(b,function(a,b){var c=b.referCode,d=c.split("|");f.open(POL_SERVER_URL+"index.html#/1300_130020?orderNo="+d[0])})},a.findBillingDeatil=function(a){var b=$("#"+a).datagrid("getSelections");return b.length<1?void $.messager.alert("提示","请选择一条记录再操作"):void $.each(b,function(a,b){var c=b.referCode,d=c.split("|");f.open(POL_SERVER_URL+"index.html#/1300_130040?billingNo="+d[1])})}}]),FolController.controller("reserveAmountDeatilChangeCtrl",["$scope","$rootScope","$timeout","ReserveService","$q","$window",function(a,b,c,d,e,f){a.istableshow=!1,c(function(){$("#ReserveDeatilWindow").panel({onBeforeOpen:function(){$("#changeAmountDataTable").attr("class","row-fluid ng-hide"),$("#freezeAmountDataTable").attr("class","row-fluid ng-hide")}});var e=$("#changeAmountDataGrid").datagrid("getPager");e.pagination({onSelectPage:function(b,c){a.reserve_deatil_data.beginNo=c*(b-1)==0?0:c*(b-1)+1,a.reserve_deatil_data.endNo=c*b,$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),d.findChangeReserveAmount(a.reserve_deatil_data,"reserve/reservedeatilchange/changedeatilreserve/query",function(a,b){$("#changeAmountDataTable").attr("class","row-fluid ng-show"),$("#changeAmountDataGrid").datagrid("loadData",a),$.messager.progress("close")},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT?$.messager.alert("提示","系统超时或请检查账号状态,如没问题请刷新页面重新操作"):$.messager.alert("提示",a.message)})}});var f=$("#freezeAmountDataGrid").datagrid("getPager");f.pagination({onSelectPage:function(b,c){a.reserve_deatil_data.beginNo=c*(b-1)==0?0:c*(b-1)+1,a.reserve_deatil_data.endNo=c*b,$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),d.findFreezeReserveAmount(a.reserve_deatil_data,"reserve/reservedeatilchange/freezedeatilreserve/query",function(a,b){$("#freezeAmountDataTable").attr("class","row-fluid ng-show"),$("#freezeAmountDataGrid").datagrid("loadData",a),$.messager.progress("close")},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT?$.messager.alert("提示","系统超时或请检查账号状态,如没问题请刷新页面重新操作"):$.messager.alert("提示",a.message)})}}),$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),d.findCodeTypeNames("reserve/reservedeatilchange/findCodeTypeNames",function(a,d){$.messager.progress("close");var e=["#deatilDealerType","#deatilBusinessCode"];c(function(){$("#deatilReserveType").combobox("loadData",b.reserveType),$("#deatilReserveType").combobox("select",b.reserveType[0].code);for(var c=0;c<a.length;c++)folUtil.isNull(a[c])||($(e[c]).combobox("loadData",a[c]),$(e[c]).combobox("select",a[c][0].code))})},function(a){$.messager.progress("close"),folUtil.isNull(a)&&$.messager.alert("提示","系统超时或请检查账号状态,如没问题请刷新页面重新操作")})}),a.findReserveDeatilChange=function(){var b=e.defer(),c=b.promise,f=!1,g=!1;return $("#startTime").datebox("getText")>$("#endTime").datebox("getText")?void $.messager.alert("提示","开始时间不能大于结束时间"):(a.reserve_deatil_data={dealerType:folUtil.getComboBoxDataById("deatilDealerType"),reserveType:folUtil.getComboBoxDataById("deatilReserveType"),sapCode:$("#deatilSapCode").textbox("getValue"),businessCode:folUtil.getComboBoxDataById("deatilBusinessCode"),startTime:$("#startTime").datebox("getValue"),endTime:$("#endTime").datebox("getValue"),beginNo:0,endNo:10},a.istableshow=!0,$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),d.findChangeReserveAmount(a.reserve_deatil_data,"reserve/reservedeatilchange/changedeatilreserve/query",function(a,c){f=!0,$("#changeAmountDataTable").attr("class","row-fluid ng-show"),$("#changeAmountDataGrid").datagrid("loadData",{total:0,rows:[]}),$("#changeAmountDataGrid").datagrid("loadData",a),g&&f&&b.resolve("success")},function(a){a.state===STATE.TIMEOUT?(console.log(a),b.reject("timeout")):b.reject("error")}),d.findFreezeReserveAmount(a.reserve_deatil_data,"reserve/reservedeatilchange/freezedeatilreserve/query",function(a,c){g=!0,$("#freezeAmountDataTable").attr("class","row-fluid ng-show"),$("#freezeAmountDataGrid").datagrid("loadData",{total:0,rows:[]}),$("#freezeAmountDataGrid").datagrid("loadData",a),g&&f&&b.resolve("success")},function(a){a.state==STATE.TIMEOUT?b.reject("timeout"):b.reject("error")}),void c.then(function(a){console.log(a),"success"==a&&$.messager.progress("close")},function(a){$.messager.progress("close"),$.messager.alert("提示","系统超时或请检查账号状态,如没问题请刷新页面重新操作")}))},a.deatilChangeResult=function(){d.getToken("services/tokens",function(b){return folUtil.isNull(a.reserve_deatil_data)?void $.messager.alert("提示","请先查询一次再导出"):(f.open("reserve/reservedeatilchange/ChangeReserveAmount?dealerType="+a.reserve_deatil_data.dealerType+"&reserveType="+a.reserve_deatil_data.reserveType+"&businessCode="+a.reserve_deatil_data.businessCode+"&sapCode="+a.reserve_deatil_data.sapCode+"&startTime="+a.reserve_deatil_data.startTime+"&endTime="+a.reserve_deatil_data.endTime+"&token="+b.token),void f.open("reserve/reservedeatilchange/FreezeReserveAmount?dealerType="+a.reserve_deatil_data.dealerType+"&reserveType="+a.reserve_deatil_data.reserveType+"&businessCode="+a.reserve_deatil_data.businessCode+"&sapCode="+a.reserve_deatil_data.sapCode+"&startTime="+a.reserve_deatil_data.startTime+"&endTime="+a.reserve_deatil_data.endTime+"&token="+b.token))},function(a){console.log(a)})},a.findOrderDeatil=function(a){var b=$("#"+a).datagrid("getSelections");return b.length<1?void $.messager.alert("提示","请选择一条记录再操作"):void $.each(b,function(a,b){var c=b.referCode,d=c.split("|");f.open(POL_SERVER_URL+"index.html#/1300_130020?orderNo="+d[0])})},a.findBillingDeatil=function(a){var b=$("#"+a).datagrid("getSelections");return b.length<1?void $.messager.alert("提示","请选择一条记录再操作"):void $.each(b,function(a,b){var c=b.referCode,d=c.split("|");f.open(POL_SERVER_URL+"index.html#/1300_130040?billingNo="+d[1])})}}]),FolController.controller("reserveMonthDeatilCtrl",["$scope","$rootScope","$timeout","ReserveService","$window",function(a,b,c,d,e){a.istableshow=!1,c(function(){var e=$("#datagrid").datagrid("getPager");e.pagination({onSelectPage:function(b,c){a.reserve_data.beginNo=c*(b-1)==0?0:c*(b-1)+1,a.reserve_data.endNo=c*b,$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),d.findReserveAmount(a.reserve_data,"reserve/reservemonthdeatil/query",function(a,b){$.messager.progress("close"),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}}),$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),d.findCodeTypeNames("reserve/reservemonthdeatil/findCodeTypeNames",function(a,d){$.messager.progress("close");var e=["#dealerType"];c(function(){$("#reserveType").combobox("loadData",b.reserveType),$("#reserveType").combobox("select",b.reserveType[0].code),folUtil.setComboBoxYearDataById("year"),folUtil.setComboBoxMonthDataById("month");for(var c=0;c<a.length;c++)folUtil.isNull(a[c])||($(e[c]).combobox("loadData",a[c]),$(e[c]).combobox("select",a[c][0].code))})},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}),a.findReserveMonthDeatil=function(){var b=folUtil.getComboBoxDataById("year")+"-"+folUtil.convertMonthToTwoPoint(folUtil.getComboBoxDataById("month"));a.reserve_data={dealerType:folUtil.getComboBoxDataById("dealerType"),reserveType:folUtil.getComboBoxDataById("reserveType"),sapCode:$("#sapCode").textbox("getValue"),dealerName:$("#dealerName").textbox("getValue"),changeTime:b,beginNo:0,endNo:10},a.istableshow=!0,$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),d.findReserveMonthDeatil(a.reserve_data,"reserve/reservemonthdeatil/query",function(a,b){$.messager.progress("close"),$("#datagrid").datagrid("loadData",{total:0,rows:[]}),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})},a.monthDeatilResult=function(){d.getToken("services/tokens",function(b){return folUtil.isNull(a.reserve_data)?void $.messager.alert("提示","请先查询一次再导出"):(console.log("sapCode2:"+a.reserve_data.sapCode),void e.open("reserve/reservemonthdeatil/monthDeatilResult?dealerName="+encodeURI(encodeURI(a.reserve_data.dealerName))+"&sapCode="+a.reserve_data.sapCode+"&dealerType="+a.reserve_data.dealerType+"&reserveType="+a.reserve_data.reserveType+"&changeTime="+a.reserve_data.changeTime+"&token="+b.token))},function(a){console.log(a)})},a.findOrderDeatil=function(a){var b=$("#"+a).datagrid("getSelections");return b.length<1?void $.messager.alert("提示","请选择一条记录再操作"):b.length>1?void $.messager.alert("提示","不能选择多条记录，请选择一条记录再操作"):b[0].referType.indexOf("SAP")>-1?void $.messager.alert("提示","该条记录不能查看订单相关信息"):void $.each(b,function(a,b){var c=b.referCode,d=c.split("|");e.open(POL_SERVER_URL+"index.html#/1300_130020?orderNo="+d[0])})},a.findBillingDeatil=function(a){var b=$("#"+a).datagrid("getSelections");return b.length<1?void $.messager.alert("提示","请选择一条记录再操作"):b.length>1?void $.messager.alert("提示","不能选择多条记录，请选择一条记录再操作"):b[0].referType.indexOf("SAP")>-1?void $.messager.alert("提示","该条记录不能查看billing相关信息"):void $.each(b,function(a,b){var c=b.referCode,d=c.split("|");e.open(POL_SERVER_URL+"index.html#/1300_130040?billingNo="+d[1])})}}]),FolController.controller("reserveAmountReconcileCtrl",["$scope","$rootScope","$timeout","ReserveService","$window",function(a,b,c,d,e){function f(){c(function(){if($("#datagrid").length>0){var b=$("#datagrid").datagrid("getPager");b.pagination({onSelectPage:function(b,c){a.reserve_data.beginNo=c*(b-1)==0?0:c*(b-1)+1,a.reserve_data.endNo=c*b,$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),d.findReserveAmountReconcile(a.reserve_data,"reserve/reserveamountreconcile/query",function(a,b){$.messager.progress("close"),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}})}},PROGRESS_ACTION_TIMEOUT)}a.istableshow=!1,a.findReserveAmountReconcile=function(){a.istableshow=!0,f();var b=folUtil.getComboBoxDataById("year")+"-"+folUtil.convertMonthToTwoPoint(folUtil.getComboBoxDataById("month"));a.reserve_data={
dealerType:folUtil.getComboBoxDataById("dealerType"),reserveType:folUtil.getComboBoxDataById("reserveType"),startSapCode:$("#startSapCode").textbox("getValue"),endSapCode:$("#endSapCode").textbox("getValue"),changeTime:b,year:folUtil.getComboBoxDataById("year"),month:folUtil.convertMonthToTwoPoint(folUtil.getComboBoxDataById("month")),difference:folUtil.getComboBoxDataById("difference"),beginNo:0,endNo:10},$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),d.findReserveAmountReconcile(a.reserve_data,"reserve/reserveamountreconcile/query",function(a,b){$.messager.progress("close"),$("#datagrid").datagrid("loadData",{total:0,rows:[]}),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})},$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),d.findCodeTypeNames("reserve/reserveamountreconcile/findCodeTypeNames",function(a,d){$.messager.progress("close");var e=["#dealerType"];c(function(){$("#reserveType").combobox("loadData",b.reserveType),$("#reserveType").combobox("select",b.reserveType[0].code),folUtil.setComboBoxYearDataById("year"),folUtil.setComboBoxMonthDataById("month"),folUtil.setComboBoxYesAndNoById("difference");for(var c=0;c<a.length;c++)folUtil.isNull(a[c])||($(e[c]).combobox("loadData",a[c]),$(e[c]).combobox("select",a[c][0].code))})},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))}),a.amountReconcile=function(){d.getToken("services/tokens",function(b,c){return folUtil.isNull(a.reserve_data)?void $.messager.alert("提示","请先查询一次再导出"):void e.open("reserve/reserveamountreconcile/amountReconcile?dealerType="+a.reserve_data.dealerType+"&reserveType="+a.reserve_data.reserveType+"&startSapCode="+a.reserve_data.startSapCode+"&endSapCode="+a.reserve_data.endSapCode+"&changeTime="+a.reserve_data.changeTime+"&year="+a.reserve_data.year+"&month="+a.reserve_data.month+"&difference="+a.reserve_data.difference+"&token="+b.token)},function(a){console.log(a)})}}]),FolController.controller("FundBalanceStatementCtrl",["$scope","$rootScope","$timeout","FundBalanceStatementService","CodeService","$window",function(a,b,c,d,e,f){a.istableshow=!1,c(function(){var e=$("#datagrid").datagrid("getPager");e.pagination({onSelectPage:function(b,c){a.fund_data.beginNo=c*(b-1)==0?0:c*(b-1)+1,a.fund_data.endNo=c*b,$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),d.query(a.fund_data,"fund/fundBanceStatement/query",function(a,b){$.messager.progress("close"),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}}),$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),d.findCodeTypeNames("fund/fundBanceStatement/findCodeTypeNames",function(a){$.messager.progress("close");var d=["#dealerType"];c(function(){$("#reserveType").combobox("loadData",b.reserveType),$("#reserveType").combobox("select",b.reserveType[0].code);for(var c=0;c<a.length;c++)folUtil.isNull(a[c])||($(d[c]).combobox("loadData",a[c]),$(d[c]).combobox("select",a[c][0].code))})},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问")),console.log("error:"+a)})}),a.query=function(){a.fund_data={dealerType:folUtil.getComboBoxDataById("dealerType"),reserveType:folUtil.getComboBoxDataById("reserveType"),endSapCode:$("#endSapCode").textbox("getValue"),startSapCode:$("#startSapCode").textbox("getValue"),dealerName:$("#dealerName").textbox("getValue"),beginNo:0,endNo:10},a.istableshow=!0,$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),d.query(a.fund_data,"fund/fundBanceStatement/query",function(a,b){$.messager.progress("close"),$("#datagrid").datagrid("loadData",{total:0,rows:[]}),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})},a.exportFile=function(){d.getToken("services/tokens",function(b,c){return folUtil.isNull(a.fund_data)?void $.messager.alert("提示","请先查询一次再导出"):($.messager.progress("close"),void f.open("fund/fundBanceStatement/exportFile?reserveType="+a.fund_data.reserveType+"&endSapCode="+a.fund_data.endSapCode+"&startSapCode="+a.fund_data.startSapCode+"&dealerType="+a.fund_data.dealerType+"&dealerName="+a.fund_data.dealerName+"&token="+b.token))},function(a){console.log(a)})}}]),FolController.controller("DealerReconciliationImportController",["$scope","$state","$timeout","$window","DealerReconciliationImportService",function(a,b,c,d,e){a.istableshow=!1,a.isdeatiltableshow=!1,c(function(){folUtil.setComboBoxYearDataById("year"),folUtil.setComboBoxMonthDataById("month");var b=$("#datagrid").datagrid("getPager");b.pagination({onSelectPage:function(b,c){a.query_data.beginNo=c*(b-1)==0?0:c*(b-1)+1,a.query_data.endNo=c*b,$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),e.query(a.query_data,"reconciliation/billFile/queryBillFile",function(a,b){$.messager.progress("close"),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}})}),a.query=function(){a.istableshow=!0;var b=folUtil.getComboBoxDataById("year")+"-"+folUtil.convertMonthToTwoPoint(folUtil.getComboBoxDataById("month"));a.$apply(function(){a.query_data={currentDate:b,year:folUtil.getComboBoxDataById("year"),month:folUtil.convertMonthToTwoPoint(folUtil.getComboBoxDataById("month")),beginNo:0,endNo:10}}),$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),e.query(a.query_data,"reconciliation/billFile/queryBillFile",function(a,b){$.messager.progress("close"),$("#datagrid").datagrid("loadData",{total:0,rows:[]}),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})},a.checkIn=function(){b.go("uploadFilePage",{pageName:"bill"})},a.checkOut=function(){if(folUtil.isNull(a.query_data))return void $.messager.alert("提示","先查询一次再导出");var b=a.query_data.year+"-"+a.query_data.month;$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),e.getToken("services/tokens",function(a){$.messager.progress("close"),d.open("reconciliation/billFile/exportBillFile?currentDate="+b+"&token="+a.token)},function(a){$.messager.progress("close"),$.messager.alert("提示","系统错误或者超时，请刷新重试")})},a.reconciliationStatusUpdateWithPublish=function(){var b=$("#datagrid").datagrid("getSelections"),c=!1;return b.length<=0?void $.messager.alert("提示","请选择需要发布的记录，再去操作发布"):($.each(b,function(a,b){return b.status==STATE.PUBLISHED?($.messager.alert("提示","该文件已发布不能再发布"),void(c=!0)):void 0}),void(c||e.getToken("services/tokens",function(c){$.each(b,function(a,b){b.token=c.token}),e.reconciliationStatusUpdate(b,"reconciliation/billFile/publishFileStatus",function(c,d){$.messager.alert("提示","发布进行中，请稍后查看"),e.query(a.query_data,"reconciliation/billFile/queryBillFile",function(a,b){$("#datagrid").datagrid("loadData",{total:0,rows:[]}),$("#datagrid").datagrid("loadData",a)},function(a){console.log(a)}),e.reconciliationStatusUpdateWithPublish(b,"reconciliation/billFile/publishFile",function(b,c){e.query(a.query_data,"reconciliation/billFile/queryBillFile",function(a,b){$("#datagrid").datagrid("loadData",{total:0,rows:[]}),$("#datagrid").datagrid("loadData",a)},function(a){console.log(a)})},function(a,b){})},function(a,b){$.messager.alert("提示","发布失败"),console.log(a)})},function(a){console.log(a)})))},a.findReconciliationDeatil=function(){var b=$("#datagrid").datagrid("getSelections");if(b.length>0){if(b[0].status===STATE.UN_PUBLISH||b[0].status===STATE.PUBLISHING)return void $.messager.alert("提示","该文件未发布不能查看明细");c(function(){var b=$("#deatildatagrid").datagrid("getPager");b.pagination({onSelectPage:function(b,c){a.query_params.beginNo=c*(b-1)==0?0:c*(b-1)+1,a.query_params.endNo=c*b,$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),e.ReconciliationSignQuery(a.query_data,"reconciliation/billFile/queryBillFileDetail",function(a,b){$.messager.progress("close"),$("#deatildatagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}})}),console.log("year1:"+a.query_data.year),$("#DeatilWindow").window("open")}else b.length>1?$.messager.alert("提示","选择多条文件，不能查看明细，请选择单条文件"):$.messager.alert("提示","请选择文件才能查看明细")}}]),FolController.controller("DealerReconciliationDeatilController",["$scope","$state","$timeout","$window","DealerReconciliationImportService",function(a,b,c,d,e){c(function(){$("#DeatilWindow").panel({onBeforeOpen:function(){$("#deatilistable").attr("class","row-fluid ng-hide"),$("#dealerCode").textbox("setValue",""),$("#dealerName").textbox("setValue",""),$("#deatilYear").textbox("setValue",a.query_data.year),$("#deatilMonth").textbox("setValue",a.query_data.month)}});var b=$("#deatildatagrid").datagrid("getPager");b.pagination({onSelectPage:function(b,c){a.query_params.beginNo=c*(b-1)==0?0:c*(b-1)+1,a.query_params.endNo=c*b,$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),e.ReconciliationSignQuery(a.query_data,"reconciliation/billFile/queryBillFileDetail",function(a,b){$.messager.progress("close"),$("#deatildatagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}})}),a.ReconciliationSignQuery=function(){console.log(a.query_data);var b=$("#deatilYear").textbox("getValue")+"-"+$("#deatilMonth").textbox("getValue");a.$apply(function(){a.query_params={currentDate:b,dealerCode:folUtil.isNull(a.dealerCode)?"":a.dealerCode,dealerName:folUtil.isNull(a.dealerName)?"":a.dealerName,beginNo:0,endNo:10}}),$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),e.ReconciliationSignQuery(a.query_params,"reconciliation/billFile/queryBillFileDetail",function(a,b){$.messager.progress("close"),$("#deatilistable").attr("class","row-fluid ng-show"),console.log($("#deatilistable").attr("class")),$("#deatildatagrid").datagrid("loadData",{total:0,rows:[]}),$("#deatildatagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})},a.exportRecDeatil=function(){var a=$("#deatildatagrid").datagrid("getSelections");return a.length>1?void $.messager.alert("提示","不能查看多条记录的明细"):a.length<1?void $.messager.alert("提示","请选择一条记录，再点击查看明细"):($.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),void e.getToken("services/tokens",function(b){$.messager.progress("close"),d.open("reconciliation/billFile/exportBillFileDetailSingle?filedId="+a[0].filedId+"&token="+b.token)},function(a){console.log(a)}))},a.checkOutDeatil=function(){var b=a.query_data.year+"-"+a.query_data.month;$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),e.getToken("services/tokens",function(c){$.messager.progress("close"),console.log("reconciliation/billFile/exportBillFileDetail?dealerCode="+a.query_params.dealerCode+"&dealerName="+a.query_params.dealerName+"&currentDate="+b+"&token="+c.token),d.open("reconciliation/billFile/exportBillFileDetail?dealerCode="+a.query_params.dealerCode+"&dealerName="+a.query_params.dealerName+"&currentDate="+b+"&token="+c.token)},function(a){$.messager.progress("close"),$.messager.alert("提示","系统错误或者超时，请刷新重试")})}}]),FolController.controller("ChaimInvoiceStatusController",["$scope","$rootScope","$q","$timeout","ChaimInvoiceStatusService","CodeService","$window",function(a,b,c,d,e,f,g){function h(){var b=$("#datagrid").datagrid("getPager");b.pagination({onSelectPage:function(b,c){a.bill_data.beginNo=c*(b-1)==0?0:c*(b-1)+1,a.bill_data.endNo=c*b,$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),e.query(a.bill_data,"invoice/statusQuery/query",function(a,b){$.messager.progress("close"),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问")),console.log("error:"+a)})}})}a.istableshow=!1,a.flag=!0,d(function(){var a=["SGM受理状态"];f.findCodeTypeNames(a,"code/findCodeTypeNames",function(a){$.messager.progress("close");for(var b=["#status"],c=0;c<a.length;c++)folUtil.isNull(a[c])||($(b[c]).combobox("loadData",a[c]),$(b[c]).combobox("select",a[c][0].code))},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}),a.query=function(){a.bill_data={sapCode:$("#sapCode").textbox("getValue"),invoiceNo:$("#invoiceNo").textbox("getValue"),expressNo:$("#expressNo").textbox("getValue"),status:folUtil.getComboBoxDataById("status"),approveMan:$("#approveMan").textbox("getValue"),beginNo:0,endNo:10},a.istableshow=!0,$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),e.query(a.bill_data,"invoice/statusQuery/query",function(b,c){$.messager.progress("close"),$("#datagrid").datagrid("loadData",{total:0,rows:[]}),$("#datagrid").datagrid("loadData",b),a.flag&&($("#datagrid").datagrid().datagrid("enableCellEditing"),h()),a.flag=!1},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问")),console.log("error:"+a)})},a.anew=function(){var b=$("#datagrid").datagrid("getChecked");if(b.length<=0)return void $.messager.alert("提示","请选择至少一条记录，再进行操作");var c="";for(var d in b)if(c.length>0&&(c+=","),c=c+b[d].invoiceNo+b[d].sapCode,5!=b[d].status)return void $.messager.alert("提示","当前状态不是SAP处理失败状态，不能给予重处理操作！");$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),e.anew({invoiceNo:c},"invoice/statusQuery/rehandle",function(b,c){$.messager.alert("提示","重处理操作成功"),$.messager.progress("close"),e.anew(a.bill_data,"invoice/statusQuery/query",function(a,b){$("#datagrid").datagrid("loadData",{total:0,rows:[]}),$("#datagrid").datagrid("loadData",a)},function(a){a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问")),console.log("error:"+a)})},function(a){return $.messager.progress("close"),a.state===STATE.TIMEOUT?(console.log("timeout"),void $.messager.alert("提示","系统超时请稍后访问")):($.messager.alert("提示","重处理操作失败"),void console.log("error:"+a))})},a.save=function(){a.endEditing("datagrid");var b=$("#datagrid").datagrid("getChecked");if(b.length<=0)return void $.messager.alert("提示","请选择至少一条记录，再进行操作");var c=[];$.each(b,function(a,b){c.push({invoiceNo:b.invoiceNo,sapCode:b.sapCode,remark:b.remark})}),$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),e.checkdata(c,"invoice/statusQuery/saveRemark/getSign",function(b,c){e.save(b.rows,"invoice/statusQuery/saveRemark",function(b,c){$.messager.alert("提示","保存成功"),$.messager.progress("close"),e.query(a.bill_data,"invoice/statusQuery/query",function(a,b){$("#datagrid").datagrid("loadData",{total:0,rows:[]}),$("#datagrid").datagrid("loadData",a)},function(a){a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问")),console.log("error:"+a)})},function(a){return $.messager.progress("close"),a.state===STATE.TIMEOUT?(console.log("timeout"),void $.messager.alert("提示","系统超时请稍后访问")):($.messager.alert("提示","保存失败"),void console.log("error:"+a))})},function(a){a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})},a.back=function(){var b=$("#datagrid").datagrid("getChecked");if(b.length<=0)return void $.messager.alert("提示","请选择至少一条记录，再进行操作");for(var c in b)if(4==b[c].status)return void $.messager.alert("提示","当前状态是SAP处理成功状态，不能给予退回操作！");var d="";$.each(b,function(a,b){d.length>0&&(d+=","),d=d+b.invoiceNo+"||"+b.sapCode}),$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),e.back({invoiceNo:d},"invoice/statusQuery/sendBack",function(b,c){$.messager.alert("提示","退回操作成功"),e.query(a.bill_data,"invoice/statusQuery/query",function(a,b){$.messager.progress("close"),$("#datagrid").datagrid("loadData",{total:0,rows:[]}),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问")),console.log("error:"+a)})},function(a){return $.messager.progress("close"),a.state===STATE.TIMEOUT?(console.log("timeout"),void $.messager.alert("提示","系统超时请稍后访问")):($.messager.alert("提示","退回操作失败"),void console.log("error:"+a))})},a.deatil=function(){var a=$("#datagrid").datagrid("getSelections");return a.length<=0?void $.messager.alert("提示","选择一条记录，再操作"):a.length>1?void $.messager.alert("提示","只能一条记录，再操作"):(b.claimStatus={},b.claimStatus.sapCode=a[0].sapCode,b.claimStatus.invoiceNo=a[0].invoiceNo,b.claimStatus.expressNo=a[0].expressNo,e.queryDeatil(b.claimStatus,"invoice/statusQuery/detail",function(a,b){$("#deatildatagrid").datagrid("loadData",{total:0,rows:[]}),$("#deatildatagrid").datagrid("loadData",a)},function(a){a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问")),console.log("error:"+a)}),void $("#DeatilWindow").window("open"))},a.endEditing=function(a){var b=$("#"+a).datagrid("getRows");$.each(b,function(a,b){$("#datagrid").datagrid("validateRow",a)&&$("#datagrid").datagrid("endEdit",a)})}}]),FolController.controller("DeatilController",["$scope","$rootScope","$state","$timeout","$window","ChaimInvoiceStatusService",function(a,b,c,d,e,f){d(function(){if($("#deatildatagrid").length>0){var b=$("#deatildatagrid").datagrid("getPager");b.pagination({onSelectPage:function(b,c){a.bill_data.beginNo=c*(b-1)==0?0:c*(b-1)+1,a.bill_data.endNo=c*b,$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),f.query(a.bill_data,"invoice/statusQuery/query",function(a,b){$.messager.progress("close"),$("#deatildatagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问")),console.log("error:"+a)})}})}}),a.exit=function(){$("#DeatilWindow").window("close"),a.bill_data={expressNo:$("#sapCode").textbox("getValue"),invoiceNo:$("#invoiceNo").textbox("getValue"),expressNo:$("#expressNo").textbox("getValue"),status:folUtil.getComboBoxDataById("status"),expressNo:$("#approveMan").textbox("getValue"),beginNo:0,endNo:10},a.istableshow=!0,$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),f.query(a.bill_data,"invoice/statusQuery/query",function(a,b){$.messager.progress("close"),$("#datagrid").datagrid("loadData",{total:0,rows:[]}),$("#deatildatagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问")),console.log("error:"+a)})}}]),FolController.controller("ExpressScanInvoiceController",["$scope","$rootScope","$q","$timeout","ExpressScanInvoiceService","$window",function(a,b,c,d,e,f){function g(){var b=$("#datagrid").datagrid("getPager");b.pagination({onSelectPage:function(b,c){a.bill_data.beginNo=c*(b-1)==0?0:c*(b-1)+1,a.bill_data.endNo=c*b,$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),e.query(a.bill_data,"invoice/expressNoScanInvoice/query",function(a,b){$.messager.progress("close"),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问")),console.log("error:"+a)})}})}a.istableshow=!1,a.query=function(){a.bill_data={invoiceNo:$("#invoiceNo").textbox("getValue"),expressNo:$("#expressNo").textbox("getValue"),sapCode:$("#sapCode").textbox("getValue"),beginNo:0,endNo:10},a.istableshow=!0,$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),e.query(a.bill_data,"invoice/expressNoScanInvoice/query",function(a,b){$.messager.progress("close"),$("#datagrid").datagrid("loadData",{total:0,rows:[]}),$("#datagrid").datagrid("loadData",a),g()},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问")),console.log("error:"+a)})},a.agree=function(){var b=$("#datagrid").datagrid("getChecked");return b.length<=0?void $.messager.alert("提示","请选择至少一条记录，再进行操作"):2!=b[0].status?void $.messager.alert("提示","当前状态已处理,不能给予操作"):($.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),void e.agree(b,"invoice/expressNoScanInvoice/auditSuccess",function(b,c){$.messager.alert("提示","同意操作成功"),e.query(a.bill_data,"invoice/expressNoScanInvoice/query",function(a,b){$.messager.progress("close"),$("#datagrid").datagrid("loadData",{total:0,rows:[]}),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})},function(a){return $.messager.progress("close"),a.state===STATE.TIMEOUT?(console.log("timeout"),void $.messager.alert("提示","系统超时请稍后访问")):($.messager.alert("提示","同意操作失败"),void console.log("error:"+a))}))},a.back=function(){var b=$("#datagrid").datagrid("getChecked");return b.length<=0?void $.messager.alert("提示","请选择至少一条记录，再进行操作"):2!=b[0].status?void $.messager.alert("提示","当前状态已处理,不能给予操作"):($.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),void e.back(b,"invoice/expressNoScanInvoice/reject",function(b,c){$.messager.alert("提示","退回操作成功"),e.query(a.bill_data,"invoice/expressNoScanInvoice/query",function(a,b){$.messager.progress("close"),$("#datagrid").datagrid("loadData",{total:0,rows:[]}),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问")),console.log("error:"+a)})},function(a){return $.messager.progress("close"),a.state===STATE.TIMEOUT?(console.log("timeout"),void $.messager.alert("提示","系统超时请稍后访问")):($.messager.alert("提示","退回操作失败"),void console.log("error:"+a))}))}}]),FolController.controller("FinancialCertificateController",["$scope","$rootScope","$q","$timeout","FinancialCertificateService","$window",function(a,b,c,d,e,f){a.istableshow=!1,d(function(){var b=$("#datagrid").datagrid("getPager");b.pagination({onSelectPage:function(b,c){a.bill_data.beginNo=c*(b-1)==0?0:c*(b-1)+1,a.bill_data.endNo=c*b,$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),e.query(a.bill_data,"financial/certificate/query",function(a,b){$.messager.progress("close"),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问")),console.log("error:"+a)})}})}),a.query=function(){return a.bill_data={sapCode:$("#sapCode").textbox("getValue"),approveMan:$("#approveMan").textbox("getValue"),startTime:$("#startTime").datebox("getValue"),endTime:$("#endTime").datebox("getValue"),beginNo:0,endNo:10},null!=$("#startTime").datebox("getValue")&&null!=$("#endTime").datebox("getValue")&&""!=$("#startTime").datebox("getValue")&&""!=$("#endTime").datebox("getValue")&&$("#startTime").datebox("getValue")>$("#endTime").datebox("getValue")?void $.messager.alert("提示","开始时间不能大于结束时间"):(a.istableshow=!0,$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),void e.query(a.bill_data,"financial/certificate/query",function(a,b){$.messager.progress("close"),$("#datagrid").datagrid("loadData",{total:0,rows:[]}),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问")),console.log("error:"+a)}))},a.exportCertificate=function(){e.getToken("services/tokens",function(b){return folUtil.isNull(a.bill_data)?void $.messager.alert("提示","请先查询一次再导出"):($.messager.progress("close"),void f.open("financial/certificate/invoiceDeatilExp?sapCode="+a.bill_data.sapCode+"&approveMan="+encodeURI(encodeURI(a.bill_data.approveMan))+"&startTime="+a.bill_data.startTime+"&endTime="+a.bill_data.endTime+"&token="+b.token))},function(a){$.messager.progress("close"),console.log(a)})}}]),FolController.controller("InterfaceStatusController",["$scope","$rootScope","$q","$timeout","InterfaceStatusService","CodeService","$window",function(a,b,c,d,e,f,g){a.istableshow=!1,d(function(){var b=$("#datagrid").datagrid("getPager");b.pagination({onSelectPage:function(b,c){a.bill_data.beginNo=c*(b-1)==0?0:c*(b-1)+1,a.bill_data.endNo=c*b,$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),e.query(a.bill_data,"interface/status/query",function(a,b){$.messager.progress("close"),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问")),console.log("error:"+a)})}});var c=["SGM受理状态"];f.findCodeTypeNames(c,"code/findCodeTypeNames",function(a){$.messager.progress("close");var b=["#process_status"];d(function(){for(var c=0;c<a.length;c++)folUtil.isNull(a[c])||($(b[c]).combobox("loadData",a[c]),$(b[c]).combobox("select",a[c][0].code))})},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}),a.query=function(){return a.bill_data={invoiceNo:$("#invoiceNo").textbox("getValue"),process_status:folUtil.getComboBoxDataById("process_status"),startTime:$("#startTime").datebox("getValue"),endTime:$("#endTime").datebox("getValue"),beginNo:0,endNo:10},null!=$("#startTime").datebox("getValue")&&null!=$("#endTime").datebox("getValue")&&""!=$("#startTime").datebox("getValue")&&""!=$("#endTime").datebox("getValue")&&$("#startTime").datebox("getValue")>$("#endTime").datebox("getValue")?void $.messager.alert("提示","开始时间不能大于结束时间"):(a.istableshow=!0,$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),void e.query(a.bill_data,"interface/status/query",function(a,b){$.messager.progress("close"),$("#datagrid").datagrid("loadData",{total:0,rows:[]}),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问")),console.log("error:"+a)}))}}]),FolController.controller("OvertimeInvoiceController",["$scope","$rootScope","$q","$timeout","OvertimeInvoiceService","$window",function(a,b,c,d,e,f){a.istableshow=!1,d(function(){var b=$("#datagrid").datagrid("getPager");b.pagination({onSelectPage:function(b,c){a.bill_data.beginNo=c*(b-1)==0?0:c*(b-1)+1,a.bill_data.endNo=c*b,$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),e.query(a.bill_data,"overtime/invoice/query",function(a,b){$.messager.progress("close"),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问")),console.log("error:"+data)})}})}),a.query=function(){a.bill_data={sapCode:$("#sapCode").textbox("getValue"),invoiceNo:$("#invoiceNo").textbox("getValue"),expressNo:$("#expressNo").textbox("getValue"),startTime:$("#startTime").textbox("getValue"),endTime:$("#endTime").textbox("getValue"),beginNo:0,endNo:10},a.istableshow=!0,$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),e.query(a.bill_data,"overtime/invoice/query",function(a,b){$.messager.progress("close"),$("#datagrid").datagrid("loadData",{total:0,rows:[]}),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问")),console.log("error:"+a)})}}]),FolController.controller("ReturnAllowanceManagerController",["$scope","$rootScope","$timeout","$state","$stateParams","$q","$window","ReturnAllowanceManagerService","CodeService",function(a,b,c,d,e,f,g,h,i){a.istableshow=!1,a.flag=!0;var j=f.defer();j.promise;c(function(){a.setData()});var k=function(){if($("#datagrid").length>0){$("#datagrid").datagrid({onDblClickRow:function(a,b){d.go("allowanceReject",{data:b})}});var a=$("#datagrid").datagrid("getPager");a.pagination({onSelectPage:function(a,c){b.return_allowance_query_data.beginNo=c*(a-1)==0?0:c*(a-1)+1,b.return_allowance_query_data.endNo=c*a,$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),h.query(b.return_allowance_query_data,"returnallowance/query",function(a,b){$.messager.progress("close"),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}})}};a.query=function(){return a.istableshow=!0,b.return_allowance_query_data={sapCode:$("#sapCode").textbox("getValue"),dealerName:$("#dealerName").textbox("getValue"),allowanceNo:$("#allowanceNo").textbox("getValue"),expressNo:$("#expressNo").textbox("getValue"),status:"-1"===$("#status").combobox("getValue")?null:$("#status").combobox("getValue"),approveDateStart:$("#startTime").datebox("getValue"),approveDateEnd:$("#endTime").datebox("getValue"),companyCode:[],beginNo:0,endNo:10},!folUtil.isNull(b.return_allowance_query_data.approveDateStart)&&!folUtil.isNull(b.return_allowance_query_data.approveDateEnd)&&b.return_allowance_query_data.approveDateStart>b.return_allowance_query_data.approveDateEnd?void $.messager.alert("提示","开始日期不能大于结束日期"):(folUtil.isNull($("#shanghai").attr("checked"))||b.return_allowance_query_data.companyCode.push(COMPANY_CODE.SH),folUtil.isNull($("#tianjin").attr("checked"))||b.return_allowance_query_data.companyCode.push(COMPANY_CODE.TJ),folUtil.isNull($("#chongqin").attr("checked"))||b.return_allowance_query_data.companyCode.push(COMPANY_CODE.CQ),void h.query(b.return_allowance_query_data,"returnallowance/query",function(b,c){$.messager.progress("close"),a.flag&&k(),$("#datagrid").datagrid("loadData",{rows:[],total:0}),$("#datagrid").datagrid("loadData",b),a.flag=!1},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))}))},a.reset=function(){$("#sapCode").textbox("setValue",null),$("#dealerName").textbox("setValue",null),$("#allowanceNo").textbox("setValue",null),$("#expressNo").textbox("setValue",null),$("#status").combobox("select",-1),$("#startTime").datebox("setValue",null),$("#endTime").datebox("setValue",null),$("#shanghai").attr("checked",!1),$("#tianjin").attr("checked",!1),$("#chongqin").attr("checked",!1)},a.findDealer=function(){d.go("findDealer",{stateName:"allowanceScanManager"})},a.report=function(){var b=$("#datagrid").datagrid("getChecked");return b.length<=0?void $.messager.alert("提示","请选择一条记录"):void(confirm("确认开票？")&&h.report(b,"returnallowance/billing",function(b,c){$.messager.alert("提示","开票成功"),a.query()},function(a){a.state===STATE.TIMEOUT?(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问")):$.messager.alert("提示","开票失败，原因："+a.message)}))},a.reject=function(){var b=$("#datagrid").datagrid("getChecked");return b.length<=0?void $.messager.alert("提示","请选择一条记录"):void(confirm("确认拒绝？")&&h.reject(b,"returnallowance/reject",function(b,c){$.messager.alert("提示","拒绝成功"),
a.query()},function(a){a.state===STATE.TIMEOUT?(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问")):$.messager.alert("提示","拒绝失败，原因："+a.message)}))},a.exportExcel=function(){return folUtil.isNull(b.return_allowance_query_data)?void $.messager.alert("提示","请先查询一次再导出"):void h.getToken("services/tokens",function(a,b){var c=[];folUtil.isNull($("#shanghai").attr("checked"))||c.push(COMPANY_CODE.SH),folUtil.isNull($("#tianjin").attr("checked"))||c.push(COMPANY_CODE.TJ),folUtil.isNull($("#chongqin").attr("checked"))||c.push(COMPANY_CODE.CQ);var d="";angular.forEach(c,function(a,b){d+=a+","});var e="returnallowance/exportListExcel",f="?sapCode="+$("#sapCode").textbox("getValue")+"&dealerName="+encodeURI(encodeURI($("#dealerName").textbox("getValue")))+"&allowanceNo="+$("#allowanceNo").textbox("getValue")+"&expressNo="+$("#expressNo").textbox("getValue")+"&status="+("-1"===$("#status").combobox("getValue")?null:$("#status").combobox("getValue"))+"&approveDateStart="+$("#startTime").datebox("getValue")+"&approveDateEnd="+$("#endTime").datebox("getValue")+"&companyCodeStr="+d.substr(0,d.length-1);g.open(e+f)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})},a.exportTxt=function(){var a=$("#datagrid").datagrid("getChecked");if(a.length<=0)return void $.messager.alert("提示","请选择一条记录");var b="";angular.forEach(a,function(a,c){b+=a.id+","}),h.getToken("services/tokens",function(a,c){var d="returnallowance/exportBillingFile",e="?ids="+b.substr(0,b.length-1);g.open(d+e)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})},a.allowanceDeatil=function(){var a=$("#datagrid").datagrid("getChecked");return a.length<=0?void $.messager.alert("提示","请选择一条记录"):a.length>1?void $.messager.alert("提示","不能选择多条记录"):void d.go("allowanceReject",{data:a[0]})},a.setData=function(){if(folUtil.isNull(b.return_allowance_query_data)){folUtil.isNull(e.data)||$("#sapCode").textbox("setValue",e.data.sapCodes),$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT});var c=["折让单处理状态"];i.findCodeTypeNames(c,"code/findCodeTypeNames",function(a){$.messager.progress("close");if(!folUtil.isNull(a[0])){var b=[];angular.forEach(a[0],function(a,c){"3"!=a.code&&"1"!=a.code&&b.push(a)}),$("#status").combobox("loadData",b),$("#status").combobox("select",a[0][0].code)}},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}else{folUtil.isNull(b.return_allowance_query_data.sapCode)||$("#sapCode").textbox("setValue",b.return_allowance_query_data.sapCode),folUtil.isNull(b.return_allowance_query_data.dealerName)||$("#dealerName").textbox("setValue",b.return_allowance_query_data.dealerName),folUtil.isNull(b.return_allowance_query_data.allowanceNo)||$("#allowanceNo").textbox("setValue",b.return_allowance_query_data.allowanceNo),folUtil.isNull(b.return_allowance_query_data.expressNo)||$("#expressNo").textbox("setValue",b.return_allowance_query_data.expressNo),folUtil.isNull(b.return_allowance_query_data.approveDateStart)||$("#startTime").datebox("setValue",b.return_allowance_query_data.approveDateStart),folUtil.isNull(b.return_allowance_query_data.approveDateEnd)||$("#endTime").datebox("setValue",b.return_allowance_query_data.approveDateEnd),!folUtil.isNull(b.return_allowance_query_data.companyCode)&&b.return_allowance_query_data.companyCode.length>0&&angular.forEach(b.return_allowance_query_data.companyCode,function(a,b){a===COMPANY_CODE.SH?$("#shanghai").attr("checked",!0):a===COMPANY_CODE.CQ?$("#chongqin").attr("checked",!0):a===COMPANY_CODE.TJ&&$("#tianjin").attr("checked",!0)}),folUtil.isNull(e.data)||$("#sapCode").textbox("setValue",e.data.sapCodes),$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT});var c=["折让单处理状态"];i.findCodeTypeNames(c,"code/findCodeTypeNames",function(c){$.messager.progress("close");if(!folUtil.isNull(c[0])){var d=[];angular.forEach(c[0],function(a,b){"3"!=a.code&&"1"!=a.code&&d.push(a)}),$("#status").combobox("loadData",d),folUtil.isNull(b.return_allowance_query_data.status)||$("#status").combobox("select",b.return_allowance_query_data.status),a.query()}},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))}),$("#datagrid").datagrid("loadData",{rows:[],total:0})}}}]),FolController.controller("ReturnAllowanceRejectController",["$scope","$rootScope","$timeout","$state","$stateParams","$q","ReturnAllowanceManagerService",function(a,b,c,d,e,f,g){var h=f.defer(),i=h.promise;a.isShowXmlInfo=!1,a.openDeatilButtonText="展开详细信息",a.xmlInfo,c(function(){h.resolve(),i.then(function(){g.deatilQuery({id:e.data.id},"returnallowance/queryReturnAllowanceById",function(b,c){a.allowance={allowanceNo:b.allowanceNo,expressNo:b.expressNo,expressSendTime:b.expressSendTime,companyName:b.companyName,address:b.address,phone:b.phone,bankAccount:b.bankAccount,reqBillNo:b.reqBillNo,sapCode:b.sapCode,customerRemark:b.customerRemark}},function(a){a.state===STATE.TIMEOUT?(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问")):$.messager.alert("提示","查询失败，原因："+a.message)})}).then(function(){g.downlandXmlInfo("returnallowance/getXmlInfo?fileId="+e.data.filedId,function(b,c){a.xmlInfo=b},function(a){a.state===STATE.TIMEOUT?(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问")):$.messager.alert("提示","查询失败，原因："+a.message)})}),g.deatilQuery({returnOrderId:e.data.claimReturnOrderId},"returnallowance/queryReturnOrderDetailByRoId",function(a,b){$("#returndatagrid").datagrid("loadData",a)},function(a){a.state===STATE.TIMEOUT?(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问")):$.messager.alert("提示","查询失败，原因："+a.message)}),g.deatilQuery({returnOrderId:e.data.claimReturnOrderId},"returnallowance/queryInvoiceDetailByRoId",function(a,b){$("#inovicedatagrid").datagrid("loadData",a)},function(a){a.state===STATE.TIMEOUT?(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问")):$.messager.alert("提示","查询失败，原因："+a.message)})}),a.reject=function(){if(confirm("确认拒绝？")){var b={approveMsg:a.approveMsg,id:e.data.id,returnOrderNo:e.data.returnOrderNo,sapCode:e.data.sapCode,sign:e.data.sign};g.reject([b],"returnallowance/reject",function(a,b){$.messager.alert("提示","拒绝成功"),d.go("allowanceScanManager")},function(a){a.state===STATE.TIMEOUT?(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问")):$.messager.alert("提示","拒绝失败，原因："+a.message)})}},a.back=function(){d.go("allowanceScanManager")},a.openDeatil=function(){"展开详细信息"===a.openDeatilButtonText?(a.$apply(function(){a.isShowXmlInfo=!0,a.openDeatilButtonText="关闭详细信息"}),j(a.xmlInfo)):a.$apply(function(){a.isShowXmlInfo=!1,a.openDeatilButtonText="展开详细信息"})};var j=function(a){$("#ReqBillNo").textbox("setValue",a.ReqBillNo),$("#InvKind").textbox("setValue","0"===a.InvKind||"1"===a.InvKind?InvKind.specialInvoice:a.InvKind),$("#Szlb").textbox("setValue",a.Szlb),$("#TypeCode").textbox("setValue",a.TypeCode),$("#InvNo").textbox("setValue",a.InvNo),$("#date").textbox("setValue",a.date),$("#BuyerName").textbox("setValue",a.BuyerName),$("#BuyTaxCode").textbox("setValue",a.BuyTaxCode),$("#SellerName").textbox("setValue",a.SellerName),$("#SellTaxCode").textbox("setValue",a.SellTaxCode),$("#Amount").textbox("setValue",a.Amount),$("#TaxRate").textbox("setValue",a.TaxRate),$("#Tax").textbox("setValue",a.Tax),$("#ReqMemo").textbox("setValue",a.ReqMemo),$("#Reason").textbox("setValue",a.Reason),$("#Operator").textbox("setValue",a.Operator),$("#commoditydatagrid").datagrid("loadData",{total:a.RedInvReqBillMx.length,rows:a.RedInvReqBillMx})}}]);