/*! web.sgm 2016-09-28 */
FolController.controller("FundBalanceStatementCtrl",["$scope","$rootScope","$timeout","FundBalanceStatementService","CodeService","$window",function(a,b,c,d,e,f){a.istableshow=!1,c(function(){var e=$("#datagrid").datagrid("getPager");e.pagination({onSelectPage:function(b,c){a.fund_data.beginNo=c*(b-1)==0?0:c*(b-1)+1,a.fund_data.endNo=c*b,$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),d.query(a.fund_data,"fund/fundBanceStatement/query",function(a,b){$.messager.progress("close"),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})}}),$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),d.findCodeTypeNames("fund/fundBanceStatement/findCodeTypeNames",function(a){$.messager.progress("close");var d=["#dealerType"];c(function(){$("#reserveType").combobox("loadData",b.reserveType),$("#reserveType").combobox("select",b.reserveType[0].code);for(var c=0;c<a.length;c++)folUtil.isNull(a[c])||($(d[c]).combobox("loadData",a[c]),$(d[c]).combobox("select",a[c][0].code))})},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问")),console.log("error:"+a)})}),a.query=function(){a.fund_data={dealerType:folUtil.getComboBoxDataById("dealerType"),reserveType:folUtil.getComboBoxDataById("reserveType"),endSapCode:$("#endSapCode").textbox("getValue"),startSapCode:$("#startSapCode").textbox("getValue"),dealerName:$("#dealerName").textbox("getValue"),beginNo:0,endNo:10},a.istableshow=!0,$.messager.progress({title:"Please waiting",msg:"Loading data...",interval:PROGRESS_ACTION_TIMEOUT}),d.query(a.fund_data,"fund/fundBanceStatement/query",function(a,b){$.messager.progress("close"),$("#datagrid").datagrid("loadData",{total:0,rows:[]}),$("#datagrid").datagrid("loadData",a)},function(a){$.messager.progress("close"),a.state===STATE.TIMEOUT&&(console.log("timeout"),$.messager.alert("提示","系统超时请稍后访问"))})},a.exportFile=function(){d.getToken("services/tokens",function(b,c){return folUtil.isNull(a.fund_data)?void $.messager.alert("提示","请先查询一次再导出"):($.messager.progress("close"),void f.open("fund/fundBanceStatement/exportFile?reserveType="+a.fund_data.reserveType+"&endSapCode="+a.fund_data.endSapCode+"&startSapCode="+a.fund_data.startSapCode+"&dealerType="+a.fund_data.dealerType+"&dealerName="+a.fund_data.dealerName+"&token="+b.token))},function(a){console.log(a)})}}]);